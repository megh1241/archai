
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Rapid NLP-based Data Creation/Encoding using Memory Mapping &#8212; Archai</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Creating NLP-based Data" href="hf_dataset_provider.html" />
    <link rel="prev" title="Natural Language Processing" href="../nlp.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../package_structure.html">
   Package Structure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../quick_start.html">
   Quick Start
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../notebooks.html">
   Notebooks
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api.html">
     API
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/dataset_provider.html">
       Dataset Provider
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/trainer_base.html">
       Trainer (Base)
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../discrete_search.html">
     Discrete Search
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../discrete_search/search_space.html">
       Search Spaces
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../discrete_search/evaluators.html">
       Evaluators
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../discrete_search/algos.html">
       Algorithms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../discrete_search/config_search.html">
       Configuration-based Search
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../supergraph.html">
     Supergraph
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../cv.html">
     Computer Vision
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../cv/cv_dataset_provider.html">
       Dataset Provider
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../cv/pl_trainer.html">
       PyTorch-Lightining Trainer
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../nlp.html">
     Natural Language Processing
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Rapid NLP-based Data Creation/Encoding using Memory Mapping
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="hf_dataset_provider.html">
       HF Dataset Provider
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="hf_trainer.html">
       HF Trainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="nvidia_dataset_provider.html">
       NVIDIA Dataset Provider
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="nvidia_trainer.html">
       NVIDIA Trainer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="onnx_export.html">
       ONNX Export
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="torch_quantization.html">
       PyTorch Quantization
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Advanced Guide
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../advanced_guide/nas.html">
   Neural Architecture Search
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../advanced_guide/nas/discrete_search.html">
     Discrete Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../advanced_guide/nas/supergraph.html">
     Supergraph
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../advanced_guide/cv.html">
   Computer Vision
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../advanced_guide/cv/datasets.html">
     Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../advanced_guide/cv/trainers.html">
     Trainers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../advanced_guide/cv/onnx.html">
     ONNX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../advanced_guide/cv/quantization.html">
     Quantization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../advanced_guide/nlp.html">
   Natural Language Processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../advanced_guide/nlp/datasets.html">
     Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../advanced_guide/nlp/trainers.html">
     Trainers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../advanced_guide/nlp/onnx.html">
     ONNX
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../advanced_guide/nlp/quantization.html">
     Quantization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../advanced_guide/cloud.html">
   Cloud-Based Search
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../advanced_guide/cloud/azure.html">
     Azure
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contributing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../contributing/first_contribution.html">
   First Time Contributor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../contributing/documentation.html">
   Documentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../contributing/unit_tests.html">
   Unit Tests
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Support
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../support/faq.html">
   Frequently Asked Questions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../support/contact.html">
   Contact
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../support/copyright.html">
   Copyright
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../reference/api.html">
   API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../reference/api/archai.api.html">
     API
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../reference/api/archai.common.html">
     Common Packages
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../reference/api/archai.datasets.html">
     Datasets
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../reference/api/archai.datasets.cv.html">
       Computer Vision
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
      <label for="toctree-checkbox-12">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.datasets.cv.transforms.html">
         Transforms
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../reference/api/archai.datasets.nlp.html">
       Natural Language Processing
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
      <label for="toctree-checkbox-13">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.datasets.nlp.tokenizer_utils.html">
         Tokenization Utilities
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../reference/api/archai.discrete_search.html">
     Discrete Search
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../reference/api/archai.discrete_search.algos.html">
       Search Algorithms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../reference/api/archai.discrete_search.api.html">
       API
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../reference/api/archai.discrete_search.evaluators.html">
       Evaluators
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
      <label for="toctree-checkbox-15">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.discrete_search.evaluators.nlp.html">
         Natural Language Processing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.discrete_search.evaluators.pt_profiler_utils.html">
         PyTorch Profiler (Utilities)
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../reference/api/archai.discrete_search.predictors.html">
       Predictors
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../reference/api/archai.discrete_search.search_spaces.html">
       Search Spaces
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
      <label for="toctree-checkbox-16">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.discrete_search.search_spaces.config.html">
         Configuration-Based
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.discrete_search.search_spaces.natsbench_tss.html">
         NATS-Bench
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.discrete_search.search_spaces.nlp.html">
         Natural Language Processing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.discrete_search.search_spaces.segmentation_dag.html">
         Segmentation DAG
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../reference/api/archai.discrete_search.utils.html">
       Utilities
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../reference/api/archai.onnx.html">
     ONNX
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../reference/api/archai.onnx.config_utils.html">
       Configuration Utilities
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../reference/api/archai.onnx.optimization_utils.html">
       Optimization Utilities
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../reference/api/archai.quantization.html">
     Quantization
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../reference/api/archai.quantization.nlp.html">
       Natural Language Processing
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../reference/api/archai.supergraph.html">
     Supergraph
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../reference/api/archai.supergraph.algos.html">
       Algorithms
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
      <label for="toctree-checkbox-20">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.supergraph.algos.darts.html">
         DARTS
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.supergraph.algos.didarts.html">
         DiDARTS
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.supergraph.algos.divnas.html">
         DivNAS
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.supergraph.algos.gumbelsoftmax.html">
         Gumbel-Softmax
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.supergraph.algos.manual.html">
         Manual
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.supergraph.algos.nasbench101.html">
         NasBench-101
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.supergraph.algos.petridish.html">
         Petridish
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.supergraph.algos.random.html">
         Random
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.supergraph.algos.xnas.html">
         XNAS
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../reference/api/archai.supergraph.datasets.html">
       Datasets
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
      <label for="toctree-checkbox-21">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.supergraph.datasets.providers.html">
         Providers
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../reference/api/archai.supergraph.models.html">
       Models
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
      <label for="toctree-checkbox-22">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../reference/api/archai.supergraph.models.shakeshake.html">
         ShakeShake
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../reference/api/archai.supergraph.nas.html">
       Neural Architecture Search
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../reference/api/archai.supergraph.utils.html">
       Utilities
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../reference/api/archai.trainers.html">
     Trainers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
    <label for="toctree-checkbox-23">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../reference/api/archai.trainers.cv.html">
       Computer Vision
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../reference/api/archai.trainers.nlp.html">
       Natural Language Processing
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../reference/roadmap.html">
   Roadmap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../reference/changelog.html">
   Changelog
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/microsoft/archai"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/microsoft/archai/issues/new?title=Issue%20on%20page%20%2Fgetting_started/notebooks/nlp/fast_hf_dataset_provider.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/microsoft/archai/edit/master/getting_started/notebooks/nlp/fast_hf_dataset_provider.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Sections
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Rapid NLP-based Data Creation/Encoding using Memory Mapping
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Instantiating-the-Provider">
     Instantiating the Provider
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Loading-from-Cache">
   Loading from Cache
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Rapid NLP-based Data Creation/Encoding using Memory Mapping</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Sections </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Rapid NLP-based Data Creation/Encoding using Memory Mapping
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Instantiating-the-Provider">
     Instantiating the Provider
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Loading-from-Cache">
   Loading from Cache
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Rapid-NLP-based-Data-Creation/Encoding-using-Memory-Mapping">
<h1>Rapid NLP-based Data Creation/Encoding using Memory Mapping<a class="headerlink" href="#Rapid-NLP-based-Data-Creation/Encoding-using-Memory-Mapping" title="Permalink to this headline">#</a></h1>
<p>In this notebook, we will use a fast dataset provider-based abstraction that interfaces with Hugging Face’s <code class="docutils literal notranslate"><span class="pre">datasets</span></code> (and has been created by HazyResearch). The key advantage of this approach is the use of either shared memory or memory maps in Python to accelerate the caching process. Furthermore, the dataset is cached as a contiguous numpy array, enabling manipulation of data with any sequence length. This feature eliminates the need for re-encoding data for multiple lengths, streamlining
the data processing pipeline.</p>
<section id="Instantiating-the-Provider">
<h2>Instantiating the Provider<a class="headerlink" href="#Instantiating-the-Provider" title="Permalink to this headline">#</a></h2>
<p>The first step is to instantiate the <code class="docutils literal notranslate"><span class="pre">FastHfDatasetProvider</span></code>, which loads and encodes the dataset. A set of arguments can be passed to its constructor according to the user’s needs:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dataset_name</span></code>: Name of the dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dataset_config_name</span></code>: Name of the dataset configuration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_dir</span></code>: Path to the data directory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tokenizer</span></code>: Instance of tokenizer to use.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tokenizer_name</span></code>: Name of the tokenizer, if <code class="docutils literal notranslate"><span class="pre">tokenizer</span></code> has not been passed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tokenizer_max_length</span></code>: Maximum length of the tokenized sequences.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mapping_column_name</span></code>: The columns in <code class="docutils literal notranslate"><span class="pre">dataset</span></code> that should be tokenized.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">validation_split</span></code>: Fraction of the dataset to use for validation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">seed</span></code>: Random seed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_workers</span></code>: Number of workers to use for encoding.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_eos_token</span></code>: Whether to use EOS token to separate sequences.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_shared_memory</span></code>: Whether to use shared memory for caching.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cache_dir</span></code>: Root path to the cache directory.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">archai.datasets.nlp.fast_hf_dataset_provider</span> <span class="kn">import</span> <span class="n">FastHfDatasetProvider</span>

<span class="c1"># The provider will automatically download the dataset and tokenizer, encode</span>
<span class="c1"># the dataset and cache it for future use</span>
<span class="n">dataset_provider</span> <span class="o">=</span> <span class="n">FastHfDatasetProvider</span><span class="p">(</span>
    <span class="s2">&quot;glue&quot;</span><span class="p">,</span>
    <span class="n">dataset_config_name</span><span class="o">=</span><span class="s2">&quot;sst2&quot;</span><span class="p">,</span>
    <span class="n">tokenizer_name</span><span class="o">=</span><span class="s2">&quot;gpt2&quot;</span><span class="p">,</span>
    <span class="n">tokenizer_max_length</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
    <span class="n">mapping_column_name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sentence&quot;</span><span class="p">],</span>
    <span class="n">use_shared_memory</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># (inputs, labels) can be retrieved with any sequence length</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">dataset_provider</span><span class="o">.</span><span class="n">get_train_dataset</span><span class="p">(</span><span class="n">seq_len</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
<span class="n">val_dataset</span> <span class="o">=</span> <span class="n">dataset_provider</span><span class="o">.</span><span class="n">get_val_dataset</span><span class="p">(</span><span class="n">seq_len</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">val_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-02-16 14:19:39,981 - archai.datasets.nlp.fast_hf_dataset_provider — WARNING —  Shared memory is not available in Python &lt; 3.8.
2023-02-16 14:19:42,645 - archai.datasets.nlp.fast_hf_dataset_provider — WARNING —  New maximum length set for the tokenizer: 512.
2023-02-16 14:19:42,649 - archai.datasets.nlp.fast_hf_dataset_provider — INFO —  Downloading dataset ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Found cached dataset glue (C:/Users/gderosa/.cache/huggingface/datasets/glue/sst2/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d8ef210940ce4773a1675389b5061a9c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-02-16 14:19:46,295 - archai.datasets.nlp.fast_hf_dataset_provider — INFO —  Encoding dataset ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Loading cached processed dataset at C:\Users\gderosa\.cache\huggingface\datasets\glue\sst2\1.0.0\dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad\cache-4b268755324077d2.arrow
Loading cached processed dataset at C:\Users\gderosa\.cache\huggingface\datasets\glue\sst2\1.0.0\dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad\cache-3313fdb7893e6922.arrow
Loading cached processed dataset at C:\Users\gderosa\.cache\huggingface\datasets\glue\sst2\1.0.0\dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad\cache-252c3cce9291d908.arrow
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ef674e6378e8470ead207f24e0dfabed", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f977234e870643c9bce445768f2dbaa7", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b5c7bec1080c4009baf45a6f7f2f265e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-02-16 14:19:47,798 - archai.datasets.nlp.fast_hf_dataset_provider — INFO —  Saving dataset to: cache\glue\sst2\3ba1dcb015d7664117d16b85af90496896fc74ef
(tensor([24717,   649,  3200,   507,   422,   262, 21694,  4991,   220, 50256,
         3642,  1299,   645, 20868,   837,   691,  2248,  1850,   308,  3775,
          220, 50256,  5562, 10408,   663,  3435,   290, 48556,  1223,  2138,
         4950,   546,  1692,  3450,   220, 50256,  2787,  1299, 15950, 11378,
          284,  3520,   262,   976,  3690,   220, 50256,   261,   262,  5290,
        15827,    12,  1659,    12,  1169,    12,  1008,  9310, 35478, 20954,
          262, 28303,   714, 47478,   469,   510,   220, 50256,  5562,   705,
           82,  1290,  1165, 15444,   284, 17004,   884, 31194,  3513,   220,
        50256, 26567,  2536,   689,   326,   262,  3437,   286,   884,   289,
        31777,  2512, 30181,   355, 29408,  1830,   460,   991,  1210,   503,
          257,  1402,   837,  2614,  2646,   351,   281,  7016,  3355,   404,
          764,   220, 50256,  1659,   473,    84,   948,   220, 50256,    64,
        19095, 17280,    12,  1941,    12,   727,   705,    82, 26781, 19518,
          220, 50256,   533,   517,  7744,  1807,   832,   621,   287,   749,
         4600,   826,    12, 28973,   705,  7328,   220, 50256,  2188,   274,
          284, 12986, 20428,   220, 50256,  1640,   883,  3807, 31006,   508,
        13121,   326,  4600,   484,   466,   299,   470,   787,  6918,   588,
          484,   973,   284,  7471,   220, 50256,  1169,   636,   810,  2147,
          705,    82,  5836,   837,   220, 50256, 43439,   703,  2089,   428,
         3807,   373,   220, 50256,    75,   437,   617, 16247,   284,   257,
        13526,  1621,   220, 50256,  1169,  6000, 17245,   220, 50256, 36673,
         3807,   220, 50256,  4480,   465,  6678,  4430,   290, 11800,   774,
          220, 50256,   445,   917,   415,  3721,   220, 50256,  2032, 27428,
          318,  2029,   477,   546,   257,  1862,  2415,   705,    82,  1986,
          837,   290,   416, 13092,   281, 14549,  3025,  1986,  4493,   326,
         2415,   705,    82, 17188,   290,   614, 23400,   837,   340, 31137,
          764,   220, 50256,  4853,   874,   262,  2656,   290,   287,   617,
         2842,   772,   731,  1010,   340,   220, 50256,   361,  1997,   837,
          766,   340,   329,   479,  5757,  2042,   837,   508, 11665,   510,
          257,  6388,   355,   257, 26821, 14314, 10086, 46410,  3706, 11841,
        19317,   764,   220, 50256,    64,  8212,   319,   534,  1986,   220,
        50256,  8988,   422,   262, 14802,   837, 26329, 44139, 13289,   220,
        50256,  1069, 32838, 46136,   306,  3684, 16948,   290,  6028, 17049,
          555,   398,  5109,   220, 50256,   268, 30486,   416,   281, 25007,
         9404,  7668,  3350,   286, 47792, 13747,   220, 50256,  4758,  2063,
          286, 10441, 12254,   318,  4785,  1058,   262,   636,   810,  2147,
          705,    82,  5836,   837,   393,   262,   636,   810,  1223,   705,
           82,  5836,   220, 50256,   259,   995, 22041,   220, 50256,   548,
          922, 11681,  5559,   220, 50256,  1169,  7110,   318,  2147,   475,
        36741,  6816, 35478, 20954,   422,   923,   284,  5461,   837,   220,
        50256,  1169,  2223,   318,   336,   346,  1513,   220, 50256,   261,
          477, 43386,   220, 50256, 10594,  1064,  1310,   286,  1393,   287,
          428,  2646,   837,   543,   318,  1690, 32950,    88,   290, 13455,
        13134,   220, 50256,  1525,  1290,   262,  5290,  3807,   286,   262,
          614,   220, 50256, 48937,   832,   837,   220, 50256,  3549,   621,
         1194,  7559,  1266,   582, 10148, 17271,   416, 44889,   257,  7505,
         3690,   428,  8258,  2646,   220, 50256,   270,   705,    82,   546,
         2428,   749,  6490,   423,   284,  1986,   287,  4845,   290,  1312,
          892,   326,   705,    82,   644,  1312,  8288,   546,   340,  1377,
          262,  1103,  2428, 29779,  1022,   262, 14397,   290, 14897, 22992,
          220, 50256, 11718,   274,   220, 50256,   672, 35260,   284,   262,
         6224,   286]), tensor([  649,  3200,   507,   422,   262, 21694,  4991,   220, 50256,  3642,
         1299,   645, 20868,   837,   691,  2248,  1850,   308,  3775,   220,
        50256,  5562, 10408,   663,  3435,   290, 48556,  1223,  2138,  4950,
          546,  1692,  3450,   220, 50256,  2787,  1299, 15950, 11378,   284,
         3520,   262,   976,  3690,   220, 50256,   261,   262,  5290, 15827,
           12,  1659,    12,  1169,    12,  1008,  9310, 35478, 20954,   262,
        28303,   714, 47478,   469,   510,   220, 50256,  5562,   705,    82,
         1290,  1165, 15444,   284, 17004,   884, 31194,  3513,   220, 50256,
        26567,  2536,   689,   326,   262,  3437,   286,   884,   289, 31777,
         2512, 30181,   355, 29408,  1830,   460,   991,  1210,   503,   257,
         1402,   837,  2614,  2646,   351,   281,  7016,  3355,   404,   764,
          220, 50256,  1659,   473,    84,   948,   220, 50256,    64, 19095,
        17280,    12,  1941,    12,   727,   705,    82, 26781, 19518,   220,
        50256,   533,   517,  7744,  1807,   832,   621,   287,   749,  4600,
          826,    12, 28973,   705,  7328,   220, 50256,  2188,   274,   284,
        12986, 20428,   220, 50256,  1640,   883,  3807, 31006,   508, 13121,
          326,  4600,   484,   466,   299,   470,   787,  6918,   588,   484,
          973,   284,  7471,   220, 50256,  1169,   636,   810,  2147,   705,
           82,  5836,   837,   220, 50256, 43439,   703,  2089,   428,  3807,
          373,   220, 50256,    75,   437,   617, 16247,   284,   257, 13526,
         1621,   220, 50256,  1169,  6000, 17245,   220, 50256, 36673,  3807,
          220, 50256,  4480,   465,  6678,  4430,   290, 11800,   774,   220,
        50256,   445,   917,   415,  3721,   220, 50256,  2032, 27428,   318,
         2029,   477,   546,   257,  1862,  2415,   705,    82,  1986,   837,
          290,   416, 13092,   281, 14549,  3025,  1986,  4493,   326,  2415,
          705,    82, 17188,   290,   614, 23400,   837,   340, 31137,   764,
          220, 50256,  4853,   874,   262,  2656,   290,   287,   617,  2842,
          772,   731,  1010,   340,   220, 50256,   361,  1997,   837,   766,
          340,   329,   479,  5757,  2042,   837,   508, 11665,   510,   257,
         6388,   355,   257, 26821, 14314, 10086, 46410,  3706, 11841, 19317,
          764,   220, 50256,    64,  8212,   319,   534,  1986,   220, 50256,
         8988,   422,   262, 14802,   837, 26329, 44139, 13289,   220, 50256,
         1069, 32838, 46136,   306,  3684, 16948,   290,  6028, 17049,   555,
          398,  5109,   220, 50256,   268, 30486,   416,   281, 25007,  9404,
         7668,  3350,   286, 47792, 13747,   220, 50256,  4758,  2063,   286,
        10441, 12254,   318,  4785,  1058,   262,   636,   810,  2147,   705,
           82,  5836,   837,   393,   262,   636,   810,  1223,   705,    82,
         5836,   220, 50256,   259,   995, 22041,   220, 50256,   548,   922,
        11681,  5559,   220, 50256,  1169,  7110,   318,  2147,   475, 36741,
         6816, 35478, 20954,   422,   923,   284,  5461,   837,   220, 50256,
         1169,  2223,   318,   336,   346,  1513,   220, 50256,   261,   477,
        43386,   220, 50256, 10594,  1064,  1310,   286,  1393,   287,   428,
         2646,   837,   543,   318,  1690, 32950,    88,   290, 13455, 13134,
          220, 50256,  1525,  1290,   262,  5290,  3807,   286,   262,   614,
          220, 50256, 48937,   832,   837,   220, 50256,  3549,   621,  1194,
         7559,  1266,   582, 10148, 17271,   416, 44889,   257,  7505,  3690,
          428,  8258,  2646,   220, 50256,   270,   705,    82,   546,  2428,
          749,  6490,   423,   284,  1986,   287,  4845,   290,  1312,   892,
          326,   705,    82,   644,  1312,  8288,   546,   340,  1377,   262,
         1103,  2428, 29779,  1022,   262, 14397,   290, 14897, 22992,   220,
        50256, 11718,   274,   220, 50256,   672, 35260,   284,   262,  6224,
          286,   428])) (tensor([  270,   705,    82,   257, 23332,   290,  1690, 13891,  7002,   764,
          220, 50256,   403,  2704,  8589,  4420, 30942,   290, 12111,   220,
        50256, 47205,   514,   284,  2911,   326,   299, 16617,   318, 24357,
          284, 21030,   257,  1688,  3451,   355,   257,  5068,  1865, 47602,
        26479,   764,   220, 50256,  1169,  7205,   837, 24138,   837,  2647,
          837, 13483, 45501,   290,  2128,   389,   477, 34328,  1813,   262,
         3227,   705,    82, 38132,   567,  1957,   274,   764,   220, 50256,
          270,   705,    82,  3105,  1377,   845,   837,   845,  3105,   764,
          220, 50256, 16670, 49699,   351, 14733,   290,   257,  1178, 39980,
         4135, 18105,   837,   262,  2646,   318,   257, 23056,   306,  2726,
          804,   379,  1862,  1466,   764,   220, 50256,    64,  3360, 32460,
         2646,   764,   220, 50256,   273,  1804,   938,   614,   705,    82,
         5704,   351,   534,   409,    12, 22095,   764,   220, 50256,  5832,
          466,   299,   470,   423,   284,   760,   546,  2647,   284,  9144,
          262,  2646,   705,    82,  2562,  5146, 13516,   286, 10997,   290,
        19661,   764,   220, 50256,   259,  3446,  9919,  2431,   837,   749,
          286,   543,  3804,   355,  6364,   355,   611,  1312,   705,    67,
          587,  5586, 12105,   319,   281, 45329, 29680,   837, 10451,  6885,
        30895,   422, 37276,   284, 13665,  2584,   284, 10517, 26876,   764,
          220, 50256,  1169, 46814,  2890, 13289,   286,   262,  5983,  1394,
          262,  2646, 22804,   290,  1394,   262,  5386, 40112,  1513,   764,
          220, 50256,   270,  2753,   257,  6283,  1611,   286, 37296,  1272,
          284,  7030,   262, 18054,   286,   686,  4835,   329,  1706,   837,
          281,   710,   285,   451,    64,   837,   304,  1018,  1734, 35783,
          837,   290,   842,  1292,    67, 11555, 30686,  1559,   477,   287,
          262,   976,  3807,   764,   220, 50256,   986,   262,  2646, 21046,
          422,   257,  3092,   286, 14733,   357,  1223,  2622,   284,  5236,
          503,   262,  3685,  1267,  2644,   220, 50256,   732,  6808,   329,
          357,   537,  3301,   290,   279,  2518,  1267,   837,   772,   588,
          606,   837,   996,  3737,   340,   705,    82,   281,  9942,  5699,
          284, 26246,   764,   220, 50256, 10197,  9961,  3296,   481,   749,
         1884,   407,  1064,   644,   484,   705,   260,  6095,   351,  5876,
          790,  1110,  2162,   262,  3807, 16523,  1111,  5636,  2171,   290,
        14733,   764,   220, 50256,    64, 18857,   837,  1029,    12, 45564,
          863, 10530,   422,   773,   544,   326, 33954,   271,  3973, 32067,
         2647,   837,  9280,   837,  3496,   837,   290,  1029, 10512,   764,
          220, 50256,  1169, 10825,   389,  8246,   290,   481,  5587,   257,
        16384,   351,  2687,   508,   705,    82,  1683,   550,  1641, 14649,
          764,   220, 50256,  3885,  4364,   256,   265,   280,   468,   257,
        47868,   329, 10868,  9176,   326,  7842,  1958,   607, 23077, 20024,
          837,   290,   287,   428,  4187,   378, 48718, 10997,   837,   673,
          705,    82,   355,  3329,    12,  4743,   652,   409, 18478,   415,
          355,   673,   373,   287,   716,  2634, 14485,   764,   220, 50256,
          986,   262,  3807,   318,   655,   257,  8631,  1468,  9234,   764,
          220, 50256,   259,   663,  1266,  7188,   837, 22960,   257,  2089,
         1029,  1524,  3227,   286, 35537,   837,  1231,  4414,   286,  3496,
          764,   220, 50256,    79,   931,  5116,  2753,   281, 37959,   804,
          379,   262, 29442,   286,  1964, 29409,   837,   475,   340,   857,
          523,   351,   884,   281, 30690,  8216,   326,   345,  1239,   760,
          618, 14733,  5645,   290, 13574,  6140,   764,   220, 50256,  1169,
         4686,  7940,   375, 20374,   329,  1528,   532,   428,   655,  2936,
          588,   340]), tensor([  705,    82,   257, 23332,   290,  1690, 13891,  7002,   764,   220,
        50256,   403,  2704,  8589,  4420, 30942,   290, 12111,   220, 50256,
        47205,   514,   284,  2911,   326,   299, 16617,   318, 24357,   284,
        21030,   257,  1688,  3451,   355,   257,  5068,  1865, 47602, 26479,
          764,   220, 50256,  1169,  7205,   837, 24138,   837,  2647,   837,
        13483, 45501,   290,  2128,   389,   477, 34328,  1813,   262,  3227,
          705,    82, 38132,   567,  1957,   274,   764,   220, 50256,   270,
          705,    82,  3105,  1377,   845,   837,   845,  3105,   764,   220,
        50256, 16670, 49699,   351, 14733,   290,   257,  1178, 39980,  4135,
        18105,   837,   262,  2646,   318,   257, 23056,   306,  2726,   804,
          379,  1862,  1466,   764,   220, 50256,    64,  3360, 32460,  2646,
          764,   220, 50256,   273,  1804,   938,   614,   705,    82,  5704,
          351,   534,   409,    12, 22095,   764,   220, 50256,  5832,   466,
          299,   470,   423,   284,   760,   546,  2647,   284,  9144,   262,
         2646,   705,    82,  2562,  5146, 13516,   286, 10997,   290, 19661,
          764,   220, 50256,   259,  3446,  9919,  2431,   837,   749,   286,
          543,  3804,   355,  6364,   355,   611,  1312,   705,    67,   587,
         5586, 12105,   319,   281, 45329, 29680,   837, 10451,  6885, 30895,
          422, 37276,   284, 13665,  2584,   284, 10517, 26876,   764,   220,
        50256,  1169, 46814,  2890, 13289,   286,   262,  5983,  1394,   262,
         2646, 22804,   290,  1394,   262,  5386, 40112,  1513,   764,   220,
        50256,   270,  2753,   257,  6283,  1611,   286, 37296,  1272,   284,
         7030,   262, 18054,   286,   686,  4835,   329,  1706,   837,   281,
          710,   285,   451,    64,   837,   304,  1018,  1734, 35783,   837,
          290,   842,  1292,    67, 11555, 30686,  1559,   477,   287,   262,
          976,  3807,   764,   220, 50256,   986,   262,  2646, 21046,   422,
          257,  3092,   286, 14733,   357,  1223,  2622,   284,  5236,   503,
          262,  3685,  1267,  2644,   220, 50256,   732,  6808,   329,   357,
          537,  3301,   290,   279,  2518,  1267,   837,   772,   588,   606,
          837,   996,  3737,   340,   705,    82,   281,  9942,  5699,   284,
        26246,   764,   220, 50256, 10197,  9961,  3296,   481,   749,  1884,
          407,  1064,   644,   484,   705,   260,  6095,   351,  5876,   790,
         1110,  2162,   262,  3807, 16523,  1111,  5636,  2171,   290, 14733,
          764,   220, 50256,    64, 18857,   837,  1029,    12, 45564,   863,
        10530,   422,   773,   544,   326, 33954,   271,  3973, 32067,  2647,
          837,  9280,   837,  3496,   837,   290,  1029, 10512,   764,   220,
        50256,  1169, 10825,   389,  8246,   290,   481,  5587,   257, 16384,
          351,  2687,   508,   705,    82,  1683,   550,  1641, 14649,   764,
          220, 50256,  3885,  4364,   256,   265,   280,   468,   257, 47868,
          329, 10868,  9176,   326,  7842,  1958,   607, 23077, 20024,   837,
          290,   287,   428,  4187,   378, 48718, 10997,   837,   673,   705,
           82,   355,  3329,    12,  4743,   652,   409, 18478,   415,   355,
          673,   373,   287,   716,  2634, 14485,   764,   220, 50256,   986,
          262,  3807,   318,   655,   257,  8631,  1468,  9234,   764,   220,
        50256,   259,   663,  1266,  7188,   837, 22960,   257,  2089,  1029,
         1524,  3227,   286, 35537,   837,  1231,  4414,   286,  3496,   764,
          220, 50256,    79,   931,  5116,  2753,   281, 37959,   804,   379,
          262, 29442,   286,  1964, 29409,   837,   475,   340,   857,   523,
          351,   884,   281, 30690,  8216,   326,   345,  1239,   760,   618,
        14733,  5645,   290, 13574,  6140,   764,   220, 50256,  1169,  4686,
         7940,   375, 20374,   329,  1528,   532,   428,   655,  2936,   588,
          340,   750]))
</pre></div></div>
</div>
</section>
</section>
<section id="Loading-from-Cache">
<h1>Loading from Cache<a class="headerlink" href="#Loading-from-Cache" title="Permalink to this headline">#</a></h1>
<p>After loading and encoding the dataset for the first time, a cache will be created with a unique fingerprint (identifier) based on its configuration. The cached is composed by the following files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">config.json</span></code>: Dataset provider configuration (used to re-create the object when loaded from cache).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tokenizer.pkl</span></code>: Tokenizer used to encode the data (also re-created when loaded from cache).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">train.npy</span></code>: Training tokens (inputs and labels).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">validation.npy</span></code>: Validation tokens (inputs and labels).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test.npy</span></code>: Testing tokens (inputs and labels).</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">FastHfDatasetProvider</span></code> class provides a <code class="docutils literal notranslate"><span class="pre">from_cache</span></code> method which can be used to re-instantiate the cached dataset provider, in case the user wants to re-use in different places.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The caching mechanism automatically saves `config.json` and `tokenizer.pkl`,</span>
<span class="c1"># which are used to recreate the provider when calling `from_cache` method</span>
<span class="n">dataset_provider</span> <span class="o">=</span> <span class="n">FastHfDatasetProvider</span><span class="o">.</span><span class="n">from_cache</span><span class="p">(</span><span class="s2">&quot;cache/glue/sst2/3ba1dcb015d7664117d16b85af90496896fc74ef&quot;</span><span class="p">)</span>

<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">dataset_provider</span><span class="o">.</span><span class="n">get_train_dataset</span><span class="p">(</span><span class="n">seq_len</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
<span class="n">val_dataset</span> <span class="o">=</span> <span class="n">dataset_provider</span><span class="o">.</span><span class="n">get_val_dataset</span><span class="p">(</span><span class="n">seq_len</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">val_dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(tensor([24717,   649,  3200,   507,   422,   262, 21694,  4991,   220, 50256,
         3642,  1299,   645, 20868,   837,   691,  2248,  1850,   308,  3775,
          220, 50256,  5562, 10408,   663,  3435,   290, 48556,  1223,  2138,
         4950,   546,  1692,  3450,   220, 50256,  2787,  1299, 15950, 11378,
          284,  3520,   262,   976,  3690,   220, 50256,   261,   262,  5290,
        15827,    12,  1659,    12,  1169,    12,  1008,  9310, 35478, 20954,
          262, 28303,   714, 47478,   469,   510,   220, 50256,  5562,   705,
           82,  1290,  1165, 15444,   284, 17004,   884, 31194,  3513,   220,
        50256, 26567,  2536,   689,   326,   262,  3437,   286,   884,   289,
        31777,  2512, 30181,   355, 29408,  1830,   460,   991,  1210,   503,
          257,  1402,   837,  2614,  2646,   351,   281,  7016,  3355,   404,
          764,   220, 50256,  1659,   473,    84,   948,   220, 50256,    64,
        19095, 17280,    12,  1941,    12,   727,   705,    82, 26781, 19518,
          220, 50256,   533,   517,  7744,  1807,   832,   621,   287,   749,
         4600,   826,    12, 28973,   705,  7328,   220, 50256,  2188,   274,
          284, 12986, 20428,   220, 50256,  1640,   883,  3807, 31006,   508,
        13121,   326,  4600,   484,   466,   299,   470,   787,  6918,   588,
          484,   973,   284,  7471,   220, 50256,  1169,   636,   810,  2147,
          705,    82,  5836,   837,   220, 50256, 43439,   703,  2089,   428,
         3807,   373,   220, 50256,    75,   437,   617, 16247,   284,   257,
        13526,  1621,   220, 50256,  1169,  6000, 17245,   220, 50256, 36673,
         3807,   220, 50256,  4480,   465,  6678,  4430,   290, 11800,   774,
          220, 50256,   445,   917,   415,  3721,   220, 50256,  2032, 27428,
          318,  2029,   477,   546,   257,  1862,  2415,   705,    82,  1986,
          837,   290,   416, 13092,   281, 14549,  3025,  1986,  4493,   326,
         2415,   705,    82, 17188,   290,   614, 23400,   837,   340, 31137,
          764,   220, 50256,  4853,   874,   262,  2656,   290,   287,   617,
         2842,   772,   731,  1010,   340,   220, 50256,   361,  1997,   837,
          766,   340,   329,   479,  5757,  2042,   837,   508, 11665,   510,
          257,  6388,   355,   257, 26821, 14314, 10086, 46410,  3706, 11841,
        19317,   764,   220, 50256,    64,  8212,   319,   534,  1986,   220,
        50256,  8988,   422,   262, 14802,   837, 26329, 44139, 13289,   220,
        50256,  1069, 32838, 46136,   306,  3684, 16948,   290,  6028, 17049,
          555,   398,  5109,   220, 50256,   268, 30486,   416,   281, 25007,
         9404,  7668,  3350,   286, 47792, 13747,   220, 50256,  4758,  2063,
          286, 10441, 12254,   318,  4785,  1058,   262,   636,   810,  2147,
          705,    82,  5836,   837,   393,   262,   636,   810,  1223,   705,
           82,  5836,   220, 50256,   259,   995, 22041,   220, 50256,   548,
          922, 11681,  5559,   220, 50256,  1169,  7110,   318,  2147,   475,
        36741,  6816, 35478, 20954,   422,   923,   284,  5461,   837,   220,
        50256,  1169,  2223,   318,   336,   346,  1513,   220, 50256,   261,
          477, 43386,   220, 50256, 10594,  1064,  1310,   286,  1393,   287,
          428,  2646,   837,   543,   318,  1690, 32950,    88,   290, 13455,
        13134,   220, 50256,  1525,  1290,   262,  5290,  3807,   286,   262,
          614,   220, 50256, 48937,   832,   837,   220, 50256,  3549,   621,
         1194,  7559,  1266,   582, 10148, 17271,   416, 44889,   257,  7505,
         3690,   428,  8258,  2646,   220, 50256,   270,   705,    82,   546,
         2428,   749,  6490,   423,   284,  1986,   287,  4845,   290,  1312,
          892,   326,   705,    82,   644,  1312,  8288,   546,   340,  1377,
          262,  1103,  2428, 29779,  1022,   262, 14397,   290, 14897, 22992,
          220, 50256, 11718,   274,   220, 50256,   672, 35260,   284,   262,
         6224,   286]), tensor([  649,  3200,   507,   422,   262, 21694,  4991,   220, 50256,  3642,
         1299,   645, 20868,   837,   691,  2248,  1850,   308,  3775,   220,
        50256,  5562, 10408,   663,  3435,   290, 48556,  1223,  2138,  4950,
          546,  1692,  3450,   220, 50256,  2787,  1299, 15950, 11378,   284,
         3520,   262,   976,  3690,   220, 50256,   261,   262,  5290, 15827,
           12,  1659,    12,  1169,    12,  1008,  9310, 35478, 20954,   262,
        28303,   714, 47478,   469,   510,   220, 50256,  5562,   705,    82,
         1290,  1165, 15444,   284, 17004,   884, 31194,  3513,   220, 50256,
        26567,  2536,   689,   326,   262,  3437,   286,   884,   289, 31777,
         2512, 30181,   355, 29408,  1830,   460,   991,  1210,   503,   257,
         1402,   837,  2614,  2646,   351,   281,  7016,  3355,   404,   764,
          220, 50256,  1659,   473,    84,   948,   220, 50256,    64, 19095,
        17280,    12,  1941,    12,   727,   705,    82, 26781, 19518,   220,
        50256,   533,   517,  7744,  1807,   832,   621,   287,   749,  4600,
          826,    12, 28973,   705,  7328,   220, 50256,  2188,   274,   284,
        12986, 20428,   220, 50256,  1640,   883,  3807, 31006,   508, 13121,
          326,  4600,   484,   466,   299,   470,   787,  6918,   588,   484,
          973,   284,  7471,   220, 50256,  1169,   636,   810,  2147,   705,
           82,  5836,   837,   220, 50256, 43439,   703,  2089,   428,  3807,
          373,   220, 50256,    75,   437,   617, 16247,   284,   257, 13526,
         1621,   220, 50256,  1169,  6000, 17245,   220, 50256, 36673,  3807,
          220, 50256,  4480,   465,  6678,  4430,   290, 11800,   774,   220,
        50256,   445,   917,   415,  3721,   220, 50256,  2032, 27428,   318,
         2029,   477,   546,   257,  1862,  2415,   705,    82,  1986,   837,
          290,   416, 13092,   281, 14549,  3025,  1986,  4493,   326,  2415,
          705,    82, 17188,   290,   614, 23400,   837,   340, 31137,   764,
          220, 50256,  4853,   874,   262,  2656,   290,   287,   617,  2842,
          772,   731,  1010,   340,   220, 50256,   361,  1997,   837,   766,
          340,   329,   479,  5757,  2042,   837,   508, 11665,   510,   257,
         6388,   355,   257, 26821, 14314, 10086, 46410,  3706, 11841, 19317,
          764,   220, 50256,    64,  8212,   319,   534,  1986,   220, 50256,
         8988,   422,   262, 14802,   837, 26329, 44139, 13289,   220, 50256,
         1069, 32838, 46136,   306,  3684, 16948,   290,  6028, 17049,   555,
          398,  5109,   220, 50256,   268, 30486,   416,   281, 25007,  9404,
         7668,  3350,   286, 47792, 13747,   220, 50256,  4758,  2063,   286,
        10441, 12254,   318,  4785,  1058,   262,   636,   810,  2147,   705,
           82,  5836,   837,   393,   262,   636,   810,  1223,   705,    82,
         5836,   220, 50256,   259,   995, 22041,   220, 50256,   548,   922,
        11681,  5559,   220, 50256,  1169,  7110,   318,  2147,   475, 36741,
         6816, 35478, 20954,   422,   923,   284,  5461,   837,   220, 50256,
         1169,  2223,   318,   336,   346,  1513,   220, 50256,   261,   477,
        43386,   220, 50256, 10594,  1064,  1310,   286,  1393,   287,   428,
         2646,   837,   543,   318,  1690, 32950,    88,   290, 13455, 13134,
          220, 50256,  1525,  1290,   262,  5290,  3807,   286,   262,   614,
          220, 50256, 48937,   832,   837,   220, 50256,  3549,   621,  1194,
         7559,  1266,   582, 10148, 17271,   416, 44889,   257,  7505,  3690,
          428,  8258,  2646,   220, 50256,   270,   705,    82,   546,  2428,
          749,  6490,   423,   284,  1986,   287,  4845,   290,  1312,   892,
          326,   705,    82,   644,  1312,  8288,   546,   340,  1377,   262,
         1103,  2428, 29779,  1022,   262, 14397,   290, 14897, 22992,   220,
        50256, 11718,   274,   220, 50256,   672, 35260,   284,   262,  6224,
          286,   428])) (tensor([  270,   705,    82,   257, 23332,   290,  1690, 13891,  7002,   764,
          220, 50256,   403,  2704,  8589,  4420, 30942,   290, 12111,   220,
        50256, 47205,   514,   284,  2911,   326,   299, 16617,   318, 24357,
          284, 21030,   257,  1688,  3451,   355,   257,  5068,  1865, 47602,
        26479,   764,   220, 50256,  1169,  7205,   837, 24138,   837,  2647,
          837, 13483, 45501,   290,  2128,   389,   477, 34328,  1813,   262,
         3227,   705,    82, 38132,   567,  1957,   274,   764,   220, 50256,
          270,   705,    82,  3105,  1377,   845,   837,   845,  3105,   764,
          220, 50256, 16670, 49699,   351, 14733,   290,   257,  1178, 39980,
         4135, 18105,   837,   262,  2646,   318,   257, 23056,   306,  2726,
          804,   379,  1862,  1466,   764,   220, 50256,    64,  3360, 32460,
         2646,   764,   220, 50256,   273,  1804,   938,   614,   705,    82,
         5704,   351,   534,   409,    12, 22095,   764,   220, 50256,  5832,
          466,   299,   470,   423,   284,   760,   546,  2647,   284,  9144,
          262,  2646,   705,    82,  2562,  5146, 13516,   286, 10997,   290,
        19661,   764,   220, 50256,   259,  3446,  9919,  2431,   837,   749,
          286,   543,  3804,   355,  6364,   355,   611,  1312,   705,    67,
          587,  5586, 12105,   319,   281, 45329, 29680,   837, 10451,  6885,
        30895,   422, 37276,   284, 13665,  2584,   284, 10517, 26876,   764,
          220, 50256,  1169, 46814,  2890, 13289,   286,   262,  5983,  1394,
          262,  2646, 22804,   290,  1394,   262,  5386, 40112,  1513,   764,
          220, 50256,   270,  2753,   257,  6283,  1611,   286, 37296,  1272,
          284,  7030,   262, 18054,   286,   686,  4835,   329,  1706,   837,
          281,   710,   285,   451,    64,   837,   304,  1018,  1734, 35783,
          837,   290,   842,  1292,    67, 11555, 30686,  1559,   477,   287,
          262,   976,  3807,   764,   220, 50256,   986,   262,  2646, 21046,
          422,   257,  3092,   286, 14733,   357,  1223,  2622,   284,  5236,
          503,   262,  3685,  1267,  2644,   220, 50256,   732,  6808,   329,
          357,   537,  3301,   290,   279,  2518,  1267,   837,   772,   588,
          606,   837,   996,  3737,   340,   705,    82,   281,  9942,  5699,
          284, 26246,   764,   220, 50256, 10197,  9961,  3296,   481,   749,
         1884,   407,  1064,   644,   484,   705,   260,  6095,   351,  5876,
          790,  1110,  2162,   262,  3807, 16523,  1111,  5636,  2171,   290,
        14733,   764,   220, 50256,    64, 18857,   837,  1029,    12, 45564,
          863, 10530,   422,   773,   544,   326, 33954,   271,  3973, 32067,
         2647,   837,  9280,   837,  3496,   837,   290,  1029, 10512,   764,
          220, 50256,  1169, 10825,   389,  8246,   290,   481,  5587,   257,
        16384,   351,  2687,   508,   705,    82,  1683,   550,  1641, 14649,
          764,   220, 50256,  3885,  4364,   256,   265,   280,   468,   257,
        47868,   329, 10868,  9176,   326,  7842,  1958,   607, 23077, 20024,
          837,   290,   287,   428,  4187,   378, 48718, 10997,   837,   673,
          705,    82,   355,  3329,    12,  4743,   652,   409, 18478,   415,
          355,   673,   373,   287,   716,  2634, 14485,   764,   220, 50256,
          986,   262,  3807,   318,   655,   257,  8631,  1468,  9234,   764,
          220, 50256,   259,   663,  1266,  7188,   837, 22960,   257,  2089,
         1029,  1524,  3227,   286, 35537,   837,  1231,  4414,   286,  3496,
          764,   220, 50256,    79,   931,  5116,  2753,   281, 37959,   804,
          379,   262, 29442,   286,  1964, 29409,   837,   475,   340,   857,
          523,   351,   884,   281, 30690,  8216,   326,   345,  1239,   760,
          618, 14733,  5645,   290, 13574,  6140,   764,   220, 50256,  1169,
         4686,  7940,   375, 20374,   329,  1528,   532,   428,   655,  2936,
          588,   340]), tensor([  705,    82,   257, 23332,   290,  1690, 13891,  7002,   764,   220,
        50256,   403,  2704,  8589,  4420, 30942,   290, 12111,   220, 50256,
        47205,   514,   284,  2911,   326,   299, 16617,   318, 24357,   284,
        21030,   257,  1688,  3451,   355,   257,  5068,  1865, 47602, 26479,
          764,   220, 50256,  1169,  7205,   837, 24138,   837,  2647,   837,
        13483, 45501,   290,  2128,   389,   477, 34328,  1813,   262,  3227,
          705,    82, 38132,   567,  1957,   274,   764,   220, 50256,   270,
          705,    82,  3105,  1377,   845,   837,   845,  3105,   764,   220,
        50256, 16670, 49699,   351, 14733,   290,   257,  1178, 39980,  4135,
        18105,   837,   262,  2646,   318,   257, 23056,   306,  2726,   804,
          379,  1862,  1466,   764,   220, 50256,    64,  3360, 32460,  2646,
          764,   220, 50256,   273,  1804,   938,   614,   705,    82,  5704,
          351,   534,   409,    12, 22095,   764,   220, 50256,  5832,   466,
          299,   470,   423,   284,   760,   546,  2647,   284,  9144,   262,
         2646,   705,    82,  2562,  5146, 13516,   286, 10997,   290, 19661,
          764,   220, 50256,   259,  3446,  9919,  2431,   837,   749,   286,
          543,  3804,   355,  6364,   355,   611,  1312,   705,    67,   587,
         5586, 12105,   319,   281, 45329, 29680,   837, 10451,  6885, 30895,
          422, 37276,   284, 13665,  2584,   284, 10517, 26876,   764,   220,
        50256,  1169, 46814,  2890, 13289,   286,   262,  5983,  1394,   262,
         2646, 22804,   290,  1394,   262,  5386, 40112,  1513,   764,   220,
        50256,   270,  2753,   257,  6283,  1611,   286, 37296,  1272,   284,
         7030,   262, 18054,   286,   686,  4835,   329,  1706,   837,   281,
          710,   285,   451,    64,   837,   304,  1018,  1734, 35783,   837,
          290,   842,  1292,    67, 11555, 30686,  1559,   477,   287,   262,
          976,  3807,   764,   220, 50256,   986,   262,  2646, 21046,   422,
          257,  3092,   286, 14733,   357,  1223,  2622,   284,  5236,   503,
          262,  3685,  1267,  2644,   220, 50256,   732,  6808,   329,   357,
          537,  3301,   290,   279,  2518,  1267,   837,   772,   588,   606,
          837,   996,  3737,   340,   705,    82,   281,  9942,  5699,   284,
        26246,   764,   220, 50256, 10197,  9961,  3296,   481,   749,  1884,
          407,  1064,   644,   484,   705,   260,  6095,   351,  5876,   790,
         1110,  2162,   262,  3807, 16523,  1111,  5636,  2171,   290, 14733,
          764,   220, 50256,    64, 18857,   837,  1029,    12, 45564,   863,
        10530,   422,   773,   544,   326, 33954,   271,  3973, 32067,  2647,
          837,  9280,   837,  3496,   837,   290,  1029, 10512,   764,   220,
        50256,  1169, 10825,   389,  8246,   290,   481,  5587,   257, 16384,
          351,  2687,   508,   705,    82,  1683,   550,  1641, 14649,   764,
          220, 50256,  3885,  4364,   256,   265,   280,   468,   257, 47868,
          329, 10868,  9176,   326,  7842,  1958,   607, 23077, 20024,   837,
          290,   287,   428,  4187,   378, 48718, 10997,   837,   673,   705,
           82,   355,  3329,    12,  4743,   652,   409, 18478,   415,   355,
          673,   373,   287,   716,  2634, 14485,   764,   220, 50256,   986,
          262,  3807,   318,   655,   257,  8631,  1468,  9234,   764,   220,
        50256,   259,   663,  1266,  7188,   837, 22960,   257,  2089,  1029,
         1524,  3227,   286, 35537,   837,  1231,  4414,   286,  3496,   764,
          220, 50256,    79,   931,  5116,  2753,   281, 37959,   804,   379,
          262, 29442,   286,  1964, 29409,   837,   475,   340,   857,   523,
          351,   884,   281, 30690,  8216,   326,   345,  1239,   760,   618,
        14733,  5645,   290, 13574,  6140,   764,   220, 50256,  1169,  4686,
         7940,   375, 20374,   329,  1528,   532,   428,   655,  2936,   588,
          340,   750]))
</pre></div></div>
</div>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../nlp.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Natural Language Processing</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="hf_dataset_provider.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Creating NLP-based Data</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Microsoft<br/>
  
      &copy; Copyright 2023.<br/>
    Last updated on Feb 16, 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>