

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Search Algorithms &#8212; Archai</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="https://unpkg.com/mermaid@9.4.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'getting_started/notebooks/discrete_search/algos';</script>
    <link rel="canonical" href="https://microsoft.github.io/archai/getting_started/notebooks/discrete_search/algos.html" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Config Search Spaces" href="config_search.html" />
    <link rel="prev" title="Evaluators" href="evaluators.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../package_structure.html">Package Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quick_start.html">Quick Start</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../notebooks.html">Notebooks</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../api.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/dataset_provider.html">Dataset Provider</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer_base.html">Trainer (Base)</a></li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../discrete_search.html">Discrete Search</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="search_space.html">Search Spaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="evaluators.html">Evaluators</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_search.html">Configuration-based Search</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cv.html">Computer Vision</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cv/cv_dataset_provider.html">Dataset Provider</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cv/pl_trainer.html">PyTorch-Lightining Trainer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../nlp.html">Natural Language Processing</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../nlp/fast_hf_dataset_provider.html">Fast HF Dataset Provider</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nlp/hf_dataset_provider.html">HF Dataset Provider</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nlp/hf_trainer.html">HF Trainer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nlp/nvidia_dataset_provider.html">NVIDIA Dataset Provider</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nlp/nvidia_trainer.html">NVIDIA Trainer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nlp/onnx_export.html">ONNX Export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nlp/torch_quantization.html">PyTorch Quantization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nlp/tfpp_ss.html">Transformer++ Search Space</a></li>

</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../advanced_guide/cloud.html">Cloud-Based Search</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../advanced_guide/cloud/azure.html">Azure</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../advanced_guide/cloud/azure/notebooks.html">Notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced_guide/cloud/azure/notebooks/quickstart/quickstart.html">Quickstart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced_guide/cloud/azure/notebooks/text_generation/text_generation.html">Text Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../advanced_guide/cloud/azure/notebooks/multi_node_search/multi_node_search.html">Multi node search</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/first_contribution.html">First Time Contributor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/unit_tests.html">Unit Tests</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../support/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support/contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support/copyright.html">Copyright</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../reference/api.html">API</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/api/archai.api.html">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/api/archai.common.html">Common Packages</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../reference/api/archai.datasets.html">Datasets</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../reference/api/archai.datasets.cv.html">Computer Vision</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.datasets.cv.transforms.html">Transforms</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../reference/api/archai.datasets.nlp.html">Natural Language Processing</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.datasets.nlp.tokenizer_utils.html">Tokenization Utilities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../reference/api/archai.discrete_search.html">Discrete Search</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/archai.discrete_search.algos.html">Search Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/archai.discrete_search.api.html">API</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../reference/api/archai.discrete_search.evaluators.html">Evaluators</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.discrete_search.evaluators.benchmark.html">Benchmark</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.discrete_search.evaluators.nlp.html">Natural Language Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.discrete_search.evaluators.pt_profiler_utils.html">PyTorch Profiler (Utilities)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/archai.discrete_search.predictors.html">Predictors</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../reference/api/archai.discrete_search.search_spaces.html">Search Spaces</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.discrete_search.search_spaces.benchmark.html">Benchmark</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.discrete_search.search_spaces.config.html">Configuration-Based</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.discrete_search.search_spaces.cv.html">Computer Vision</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.discrete_search.search_spaces.nlp.html">Natural Language Processing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/archai.discrete_search.utils.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../reference/api/archai.onnx.html">ONNX</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/archai.onnx.config_utils.html">Configuration Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/archai.onnx.optimization_utils.html">Optimization Utilities</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../reference/api/archai.quantization.html">Quantization</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/archai.quantization.nlp.html">Natural Language Processing</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../reference/api/archai.supergraph.html">Supergraph</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../reference/api/archai.supergraph.algos.html">Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.supergraph.algos.darts.html">DARTS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.supergraph.algos.didarts.html">DiDARTS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.supergraph.algos.divnas.html">DivNAS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.supergraph.algos.gumbelsoftmax.html">Gumbel-Softmax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.supergraph.algos.manual.html">Manual</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.supergraph.algos.nasbench101.html">NasBench-101</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.supergraph.algos.petridish.html">Petridish</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.supergraph.algos.random.html">Random</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.supergraph.algos.xnas.html">XNAS</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../reference/api/archai.supergraph.datasets.html">Datasets</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.supergraph.datasets.providers.html">Providers</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../reference/api/archai.supergraph.models.html">Models</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../reference/api/archai.supergraph.models.shakeshake.html">ShakeShake</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/archai.supergraph.nas.html">Neural Architecture Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/archai.supergraph.utils.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../reference/api/archai.trainers.html">Trainers</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/archai.trainers.cv.html">Computer Vision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../reference/api/archai.trainers.nlp.html">Natural Language Processing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/changelog.html">Changelog</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/microsoft/archai" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/microsoft/archai/issues/new?title=Issue%20on%20page%20%2Fgetting_started/notebooks/discrete_search/algos.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Search Algorithms</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Sections </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Dataset-Provider">Dataset Provider</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Wrapping-custom-evaluation-code">Wrapping custom evaluation code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Defining-Search-Objectives">Defining Search Objectives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-objectives">Adding objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-extra-constraints">Adding extra constraints</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Using-a-search-algorithm">Using a search algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Example:-EvolutionParetoSearch">Example: <code class="docutils literal notranslate"><span class="pre">EvolutionParetoSearch</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Troubleshooting">Troubleshooting</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="Search-Algorithms">
<h1>Search Algorithms<a class="headerlink" href="#Search-Algorithms" title="Permalink to this headline">#</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">overrides</span> <span class="kn">import</span> <span class="n">overrides</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">Random</span>

<span class="kn">from</span> <span class="nn">archai.discrete_search.api</span> <span class="kn">import</span> <span class="n">ArchaiModel</span><span class="p">,</span> <span class="n">EvolutionarySearchSpace</span><span class="p">,</span> <span class="n">BayesOptSearchSpace</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1680142434.3962104
</pre></div></div>
</div>
<p>We will re-use the CNN search space created in the <a class="reference internal" href="search_space.html"><span class="doc">search space example</span></a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">model</span> <span class="kn">import</span> <span class="n">MyModel</span>
<span class="kn">from</span> <span class="nn">cnn_search_space</span> <span class="kn">import</span> <span class="n">CNNSearchSpaceExt</span> <span class="k">as</span> <span class="n">CNNSearchSpace</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ss</span> <span class="o">=</span> <span class="n">CNNSearchSpace</span><span class="p">(</span><span class="n">max_layers</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">kernel_list</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">hidden_list</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ArchaiModel(
        archid=L=3, K=7, H=16,
        metadata={},
        arch=MyModel(
  (model): Sequential(
    (0): Conv2d(1, 16, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3))
    (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Conv2d(16, 16, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3))
    (4): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU()
    (6): Conv2d(16, 16, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3))
    (7): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU()
    (9): AdaptiveAvgPool2d(output_size=(1, 1))
    (10): Conv2d(16, 10, kernel_size=(1, 1), stride=(1, 1))
  )
)
)
</pre></div></div>
</div>
<section id="Dataset-Provider">
<h2>Dataset Provider<a class="headerlink" href="#Dataset-Provider" title="Permalink to this headline">#</a></h2>
<p>Datasets are represented in Archai throught the <code class="docutils literal notranslate"><span class="pre">`DatasetProvider</span></code> &lt;../../reference/api/archai.discrete_search.api.rst&gt;`__ class. For this example, we will use the built-in dataset provider of the MNIST dataset.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">archai.datasets.cv.mnist_dataset_provider</span> <span class="kn">import</span> <span class="n">MnistDatasetProvider</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_provider</span> <span class="o">=</span> <span class="n">MnistDatasetProvider</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We can get train/test PyTorch datasets from a DatasetProvider by calling <code class="docutils literal notranslate"><span class="pre">dataset_provider.get_datasets(load_train,</span> <span class="pre">load_test,</span> <span class="pre">transforms_train,</span> <span class="pre">transforms_test)</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loads only the training set</span>
<span class="n">tr_d</span> <span class="o">=</span> <span class="n">dataset_provider</span><span class="o">.</span><span class="n">get_train_dataset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Wrapping-custom-evaluation-code">
<h2>Wrapping custom evaluation code<a class="headerlink" href="#Wrapping-custom-evaluation-code" title="Permalink to this headline">#</a></h2>
<p>We will evaluate the models using partial training validation accuracy as a proxy for final task performance. This notebook will take about an hour to complete if you run it on a Intel Core i9 CPU. If you have CUDA enabled version of pytorch installed, it will be about 30 minutes if you pass the <code class="docutils literal notranslate"><span class="pre">device</span></code> argument <code class="docutils literal notranslate"><span class="pre">cuda</span></code> in the following <code class="docutils literal notranslate"><span class="pre">PartialTrainingValAccuracy</span></code> constructor.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">archai.api.dataset_provider</span> <span class="kn">import</span> <span class="n">DatasetProvider</span>
<span class="kn">from</span> <span class="nn">archai.discrete_search.api</span> <span class="kn">import</span> <span class="n">ModelEvaluator</span>
<span class="kn">from</span> <span class="nn">archai.discrete_search.evaluators</span> <span class="kn">import</span> <span class="n">RayParallelEvaluator</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">math</span>


<span class="k">class</span> <span class="nc">PartialTrainingValAccuracy</span><span class="p">(</span><span class="n">ModelEvaluator</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">DatasetProvider</span><span class="p">,</span> <span class="n">training_epochs</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">lr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span><span class="p">,</span>
                 <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">training_epochs</span> <span class="o">=</span> <span class="n">training_epochs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_provider</span> <span class="o">=</span> <span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span> <span class="o">=</span> <span class="n">progress_bar</span>

    <span class="nd">@overrides</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">budget</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="c1"># Loads the dataset</span>
        <span class="n">tr_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_provider</span><span class="o">.</span><span class="n">get_train_dataset</span><span class="p">()</span>
        <span class="n">val_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_provider</span><span class="o">.</span><span class="n">get_val_dataset</span><span class="p">()</span>

        <span class="n">tr_dl</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">tr_data</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">val_dl</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">val_data</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

        <span class="c1"># Training settings</span>
        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">arch</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lr</span><span class="p">)</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>

        <span class="n">model</span><span class="o">.</span><span class="n">arch</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
        <span class="n">model</span><span class="o">.</span><span class="n">arch</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

        <span class="c1"># Partial training</span>
        <span class="n">epoch_iter</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">training_epochs</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_bar</span><span class="p">:</span>
            <span class="n">epoch_iter</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">epoch_iter</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Training model </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">archid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">epoch_nb</span> <span class="ow">in</span> <span class="n">epoch_iter</span><span class="p">:</span>
            <span class="c1"># Early stops for fractional values of training epochs (e.g, 0.2)</span>
            <span class="n">early_stop</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tr_dl</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">training_epochs</span> <span class="o">-</span> <span class="n">epoch_nb</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">early_stop</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">training_epochs</span> <span class="o">-</span> <span class="n">epoch_nb</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">tr_dl</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tr_dl</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">early_stop</span><span class="p">:</span>
                    <span class="k">break</span>

                <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

                <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">arch</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">))</span>
                <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">))</span>

                <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
                <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="c1"># Evaluates final model</span>
        <span class="n">model</span><span class="o">.</span><span class="n">arch</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="n">val_pred</span><span class="p">,</span> <span class="n">val_target</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">val_dl</span><span class="p">:</span>
                <span class="n">val_pred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">arch</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">))</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">))</span>
                <span class="n">val_target</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">))</span>

            <span class="n">val_pred</span><span class="p">,</span> <span class="n">val_target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">val_pred</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">val_target</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">val_acc</span> <span class="o">=</span> <span class="p">(</span><span class="n">val_pred</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> <span class="o">==</span> <span class="n">val_target</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="c1"># Returns model to cpu</span>
        <span class="n">model</span><span class="o">.</span><span class="n">arch</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">val_acc</span>
</pre></div>
</div>
</div>
<p>Let’s test our evaluator:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">partial_tr</span> <span class="o">=</span> <span class="n">PartialTrainingValAccuracy</span><span class="p">(</span>
    <span class="n">dataset_provider</span><span class="p">,</span>
    <span class="n">training_epochs</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="c1"># Trains for 1/1000 of an epoch</span>
    <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>This evaluation is pretty quick, even on a CPU, at around 10 seconds on an Intel Core i9 processor.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">partial_tr</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">random_sample</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Training model L=5, K=3, H=32: 100%|██████████| 1/1 [00:02&lt;00:00,  2.04s/it]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.1009
</pre></div></div>
</div>
<p>We can make this objective more efficient evaluating multiple architectures in parallel. To do that, we can use the <code class="docutils literal notranslate"><span class="pre">RayParallelObjective</span></code> wrapper mentioned in the <a class="reference internal" href="evaluators.html"><span class="doc">previous example</span></a>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">parallel_partial_tr</span> <span class="o">=</span> <span class="n">RayParallelEvaluator</span><span class="p">(</span><span class="n">partial_tr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s test our partial training objective sending two random architectures</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">parallel_partial_tr</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">random_sample</span><span class="p">())</span>
<span class="n">parallel_partial_tr</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">random_sample</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-03-29 19:14:10,446 INFO worker.py:1538 -- Started a local Ray instance.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">parallel_partial_tr</span><span class="o">.</span><span class="n">fetch_all</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Training model L=7, K=3, H=16:   0%|          | 0/1 [00:00&lt;?, ?it/s]
Training model L=8, K=5, H=64:   0%|          | 0/1 [00:00&lt;?, ?it/s]
Training model L=7, K=3, H=16: 100%|██████████| 1/1 [00:03&lt;00:00,  3.55s/it]
Training model L=8, K=5, H=64: 100%|██████████| 1/1 [00:05&lt;00:00,  5.11s/it]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.1135, 0.0892]
</pre></div></div>
</div>
<p>To run the same objective distributing jobs across multiple GPUs, just set the <code class="docutils literal notranslate"><span class="pre">num_gpus</span></code> parameter from <a class="reference external" href="https://docs.ray.io/en/latest/ray-core/package-ref.html#ray-init">ray.init</a> and set <code class="docutils literal notranslate"><span class="pre">device='cuda'</span></code> (This assumes you have installed the NVidia CUDA SDK and PyTorch for CUDA as per the setup instructions at <a class="reference external" href="https://pytorch.org/get-started/locally/">https://pytorch.org/get-started/locally/</a>)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">RayParallelObjective</span><span class="p">(</span>
    <span class="n">PartialTrainingValAccuracy</span><span class="p">(</span><span class="n">training_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">),</span>
    <span class="n">num_gpus</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="c1"># 2 jobs per gpu available</span>
    <span class="n">max_calls</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="Defining-Search-Objectives">
<h2>Defining Search Objectives<a class="headerlink" href="#Defining-Search-Objectives" title="Permalink to this headline">#</a></h2>
<p>Search optimization objectives are specified using the <code class="docutils literal notranslate"><span class="pre">archai.discrete_search.SearchObjectives</span></code> class</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">archai.discrete_search.api</span> <span class="kn">import</span> <span class="n">SearchObjectives</span>

<span class="n">objectives</span> <span class="o">=</span> <span class="n">SearchObjectives</span><span class="p">()</span>
</pre></div>
</div>
</div>
<section id="Adding-objectives">
<h3>Adding objectives<a class="headerlink" href="#Adding-objectives" title="Permalink to this headline">#</a></h3>
<p>To add search objectives, we can use the <code class="docutils literal notranslate"><span class="pre">SearchObjectives.add_objective</span></code> method</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">archai.discrete_search.evaluators</span> <span class="kn">import</span> <span class="n">AvgOnnxLatency</span><span class="p">,</span> <span class="n">TorchFlops</span>

<span class="n">objectives</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span>
    <span class="c1"># Objective function name (will be used in plots and reports)</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ONNX Latency (ms)&#39;</span><span class="p">,</span>

    <span class="c1"># ModelEvaluator object that will be used to evaluate the model</span>
    <span class="n">model_evaluator</span><span class="o">=</span><span class="n">AvgOnnxLatency</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">num_trials</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>

    <span class="c1"># Optimization direction, `True` for maximization or `False` for minimization</span>
    <span class="n">higher_is_better</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>

    <span class="c1"># Whether this objective should be considered &#39;compute intensive&#39; or not.</span>
    <span class="n">compute_intensive</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">compute_intensive</span></code> flag is used in some search algorithms to help increase search efficiency. For instance, search algorithms that use surrogate models may try to estimate the value of expensive objective functions of unseen architectures in certain situations, while cheap objectives (<code class="docutils literal notranslate"><span class="pre">compute_intensive=False</span></code>) will just be computed directly.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">objectives</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span>
    <span class="s1">&#39;FLOPs&#39;</span><span class="p">,</span> <span class="n">TorchFlops</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
    <span class="n">higher_is_better</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">compute_intensive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># We may optionally add a constraint.</span>
    <span class="c1"># Architectures outside this range will be ignored by the search algorithm</span>
    <span class="n">constraint</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Additionally, objectives that are cheap to evaluate (<code class="docutils literal notranslate"><span class="pre">compute_intensive=False</span></code>) may receive an optional <code class="docutils literal notranslate"><span class="pre">constraint</span></code> argument. Model candidates outside this range will be ignored by the search algorithm.</p>
<p>We can evaluate cheap objectives calling <code class="docutils literal notranslate"><span class="pre">SearchObjectives.eval_cheap_objs(model_list)</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">objectives</span><span class="o">.</span><span class="n">eval_cheap_objs</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span>
                           <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Calculating &#34;ONNX Latency (ms)&#34;...: 100%|██████████| 2/2 [00:00&lt;00:00,  9.76it/s]
Calculating &#34;FLOPs&#34;...: 100%|██████████| 2/2 [00:00&lt;00:00, 23.84it/s]
Gathering results from async objectives...: 0it [00:00, ?it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;ONNX Latency (ms)&#39;: array([0.00050963, 0.0002865 ]),
 &#39;FLOPs&#39;: array([1.02434954e+08, 1.19607370e+08])}
</pre></div></div>
</div>
<p>We can check if a model satisfies the constraints we added for the FLOPs objective by calling <code class="docutils literal notranslate"><span class="pre">SearchObjectives.validate_constraints(model_list)</span></code> or <code class="docutils literal notranslate"><span class="pre">SearchObjectives.is_model_valid(ss.random_sample())</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">random_sample</span><span class="p">()</span>

<span class="n">objectives</span><span class="o">.</span><span class="n">validate_constraints</span><span class="p">([</span><span class="n">m</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
({&#39;FLOPs&#39;: array([1.1281083e+09])}, array([], dtype=int64))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">objectives</span><span class="o">.</span><span class="n">is_model_valid</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
</pre></div></div>
</div>
<p>By default, all objective and constraints evaluations are cached to prevent spending resources in the same architecture twice.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The evaluation cache is built using the</span>
<span class="c1"># tuple (obj_name, archid, budget)</span>
<span class="n">objectives</span><span class="o">.</span><span class="n">lookup_cache</span><span class="p">(</span><span class="s1">&#39;FLOPs&#39;</span><span class="p">,</span> <span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">archid</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
102434954
</pre></div></div>
</div>
<p>Caching can be disabled setting <code class="docutils literal notranslate"><span class="pre">SearchObjectives(cache_objective_evaluation=False)</span></code>.</p>
<p>Now, let’s try adding the partial training objective we created before.</p>
<div class="alert alert-block alert-warning"><p>The code below requests a GPU compatible with CUDA. If running on CPU, that’s ok, it will just fall back to CPU training.</p>
</div><div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">objectives</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span>
    <span class="s1">&#39;Partial training Validation Accuracy (1 epoch)&#39;</span><span class="p">,</span>
    <span class="n">RayParallelEvaluator</span><span class="p">(</span>
        <span class="n">PartialTrainingValAccuracy</span><span class="p">(</span><span class="n">dataset_provider</span><span class="p">,</span> <span class="n">training_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">),</span>
        <span class="n">num_gpus</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="c1"># 2 jobs per gpu available</span>
        <span class="n">max_calls</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">),</span>
    <span class="n">higher_is_better</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">compute_intensive</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># This is a compute intensive evaluator</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Expensive objectives can be evaluated using <code class="docutils literal notranslate"><span class="pre">SearchObjectives.eval_expensive_objs(model_list)</span></code></p>
<p>Alternatively, all objectives (expensive and cheap) can also be evaluated using <code class="docutils literal notranslate"><span class="pre">SearchObjectives.eval_all_objs</span></code>.</p>
</section>
<section id="Adding-extra-constraints">
<h3>Adding extra constraints<a class="headerlink" href="#Adding-extra-constraints" title="Permalink to this headline">#</a></h3>
<p>Besides the constraint parameter from cheap objectives, it is also possible to add extra constraints that are not search objectives (and thus should not be optimized by NAS algorithms).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">archai.discrete_search.evaluators</span> <span class="kn">import</span> <span class="n">TorchNumParameters</span>

<span class="n">objectives</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span>
    <span class="s1">&#39;Number of parameters&#39;</span><span class="p">,</span>
    <span class="n">TorchNumParameters</span><span class="p">(),</span>
    <span class="n">constraint</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">objectives</span><span class="o">.</span><span class="n">validate_constraints</span><span class="p">([</span><span class="n">m</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
({&#39;Number of parameters&#39;: array([720586.]), &#39;FLOPs&#39;: array([1.1281083e+09])},
 array([], dtype=int64))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">objectives</span><span class="o">.</span><span class="n">is_model_valid</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
</pre></div></div>
</div>
</section>
</section>
<section id="Using-a-search-algorithm">
<h2>Using a search algorithm<a class="headerlink" href="#Using-a-search-algorithm" title="Permalink to this headline">#</a></h2>
<p>Now that we know how to create and use search objectives, we can finally use a search algorithm do to Neural Architecture Search!</p>
<section id="Example:-EvolutionParetoSearch">
<h3>Example: <code class="docutils literal notranslate"><span class="pre">EvolutionParetoSearch</span></code><a class="headerlink" href="#Example:-EvolutionParetoSearch" title="Permalink to this headline">#</a></h3>
<p>Let’s start with an evolutionary-based search algorithm</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">archai.discrete_search.algos</span> <span class="kn">import</span> <span class="n">EvolutionParetoSearch</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">algo</span> <span class="o">=</span> <span class="n">EvolutionParetoSearch</span><span class="p">(</span>
    <span class="n">ss</span><span class="p">,</span> <span class="n">objectives</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;./out_evo&#39;</span><span class="p">,</span>
    <span class="n">num_iters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_crossovers</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">mutations_per_parent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">max_unseen_population</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">save_pareto_model_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">search_results</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">search</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:16:04,354 - archai.discrete_search.algos.evolution_pareto — INFO —  Using 10 random architectures as the initial population ...
2023-03-29 19:16:04,536 - archai.discrete_search.algos.evolution_pareto — INFO —  Iteration 1/5
2023-03-29 19:16:04,537 - archai.discrete_search.algos.evolution_pareto — INFO —  Calculating search objectives [&#39;ONNX Latency (ms)&#39;, &#39;FLOPs&#39;, &#39;Partial training Validation Accuracy (1 epoch)&#39;] for 10 models ...
2023-03-29 19:19:42,179 - archai.discrete_search.algos.evolution_pareto — INFO —  Updating Pareto frontier ...
2023-03-29 19:19:42,180 - archai.discrete_search.algos.evolution_pareto — INFO —  Found 7 members.
2023-03-29 19:19:42,651 - archai.discrete_search.algos.evolution_pareto — INFO —  Optimzing memory usage ...
2023-03-29 19:19:42,652 - archai.discrete_search.algos.evolution_pareto — INFO —  Choosing 7 parents ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Mutating parents: 100%|██████████| 7/7 [00:00&lt;00:00, 52.68it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:19:42,788 - archai.discrete_search.algos.evolution_pareto — INFO —  Mutation: 12 new models.
2023-03-29 19:19:42,794 - archai.discrete_search.algos.evolution_pareto — INFO —  Crossover: 1 new models.
2023-03-29 19:19:42,841 - archai.discrete_search.algos.evolution_pareto — INFO —  Total unseen population: 18.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:19:42,841 - archai.discrete_search.algos.evolution_pareto — INFO —  Total unseen population after `max_unseen_population` restriction: 10.
2023-03-29 19:19:42,841 - archai.discrete_search.algos.evolution_pareto — INFO —  Iteration 2/5
2023-03-29 19:19:42,841 - archai.discrete_search.algos.evolution_pareto — INFO —  Calculating search objectives [&#39;ONNX Latency (ms)&#39;, &#39;FLOPs&#39;, &#39;Partial training Validation Accuracy (1 epoch)&#39;] for 10 models ...
2023-03-29 19:24:37,502 - archai.discrete_search.algos.evolution_pareto — INFO —  Updating Pareto frontier ...
2023-03-29 19:24:37,504 - archai.discrete_search.algos.evolution_pareto — INFO —  Found 11 members.
2023-03-29 19:24:37,870 - archai.discrete_search.algos.evolution_pareto — INFO —  Optimzing memory usage ...
2023-03-29 19:24:37,872 - archai.discrete_search.algos.evolution_pareto — INFO —  Choosing 11 parents ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Mutating parents: 100%|██████████| 11/11 [00:00&lt;00:00, 43.14it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:24:38,129 - archai.discrete_search.algos.evolution_pareto — INFO —  Mutation: 18 new models.
2023-03-29 19:24:38,129 - archai.discrete_search.algos.evolution_pareto — INFO —  Crossover: 0 new models.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:24:38,200 - archai.discrete_search.algos.evolution_pareto — INFO —  Total unseen population: 23.
2023-03-29 19:24:38,200 - archai.discrete_search.algos.evolution_pareto — INFO —  Total unseen population after `max_unseen_population` restriction: 10.
2023-03-29 19:24:38,201 - archai.discrete_search.algos.evolution_pareto — INFO —  Iteration 3/5
2023-03-29 19:24:38,201 - archai.discrete_search.algos.evolution_pareto — INFO —  Calculating search objectives [&#39;ONNX Latency (ms)&#39;, &#39;FLOPs&#39;, &#39;Partial training Validation Accuracy (1 epoch)&#39;] for 10 models ...
2023-03-29 19:33:04,545 - archai.discrete_search.algos.evolution_pareto — INFO —  Updating Pareto frontier ...
2023-03-29 19:33:04,548 - archai.discrete_search.algos.evolution_pareto — INFO —  Found 17 members.
2023-03-29 19:33:04,960 - archai.discrete_search.algos.evolution_pareto — INFO —  Optimzing memory usage ...
2023-03-29 19:33:04,962 - archai.discrete_search.algos.evolution_pareto — INFO —  Choosing 17 parents ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Mutating parents: 100%|██████████| 17/17 [00:00&lt;00:00, 30.02it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:33:05,532 - archai.discrete_search.algos.evolution_pareto — INFO —  Mutation: 25 new models.
2023-03-29 19:33:05,553 - archai.discrete_search.algos.evolution_pareto — INFO —  Crossover: 1 new models.
2023-03-29 19:33:05,563 - archai.discrete_search.algos.evolution_pareto — INFO —  Total unseen population: 31.
2023-03-29 19:33:05,563 - archai.discrete_search.algos.evolution_pareto — INFO —  Total unseen population after `max_unseen_population` restriction: 10.
2023-03-29 19:33:05,578 - archai.discrete_search.algos.evolution_pareto — INFO —  Iteration 4/5
2023-03-29 19:33:05,578 - archai.discrete_search.algos.evolution_pareto — INFO —  Calculating search objectives [&#39;ONNX Latency (ms)&#39;, &#39;FLOPs&#39;, &#39;Partial training Validation Accuracy (1 epoch)&#39;] for 10 models ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:40:54,762 - archai.discrete_search.algos.evolution_pareto — INFO —  Updating Pareto frontier ...
2023-03-29 19:40:54,767 - archai.discrete_search.algos.evolution_pareto — INFO —  Found 20 members.
2023-03-29 19:40:55,187 - archai.discrete_search.algos.evolution_pareto — INFO —  Optimzing memory usage ...
2023-03-29 19:40:55,188 - archai.discrete_search.algos.evolution_pareto — INFO —  Choosing 20 parents ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Mutating parents: 100%|██████████| 20/20 [00:00&lt;00:00, 38.02it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:40:55,716 - archai.discrete_search.algos.evolution_pareto — INFO —  Mutation: 25 new models.
2023-03-29 19:40:55,737 - archai.discrete_search.algos.evolution_pareto — INFO —  Crossover: 1 new models.
2023-03-29 19:40:55,749 - archai.discrete_search.algos.evolution_pareto — INFO —  Total unseen population: 31.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:40:55,750 - archai.discrete_search.algos.evolution_pareto — INFO —  Total unseen population after `max_unseen_population` restriction: 10.
2023-03-29 19:40:55,751 - archai.discrete_search.algos.evolution_pareto — INFO —  Iteration 5/5
2023-03-29 19:40:55,751 - archai.discrete_search.algos.evolution_pareto — INFO —  Calculating search objectives [&#39;ONNX Latency (ms)&#39;, &#39;FLOPs&#39;, &#39;Partial training Validation Accuracy (1 epoch)&#39;] for 10 models ...
2023-03-29 19:46:08,378 - archai.discrete_search.algos.evolution_pareto — INFO —  Updating Pareto frontier ...
2023-03-29 19:46:08,384 - archai.discrete_search.algos.evolution_pareto — INFO —  Found 23 members.
2023-03-29 19:46:08,844 - archai.discrete_search.algos.evolution_pareto — INFO —  Optimzing memory usage ...
2023-03-29 19:46:08,844 - archai.discrete_search.algos.evolution_pareto — INFO —  Choosing 23 parents ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Mutating parents: 100%|██████████| 23/23 [00:00&lt;00:00, 30.64it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:46:09,612 - archai.discrete_search.algos.evolution_pareto — INFO —  Mutation: 23 new models.
2023-03-29 19:46:09,632 - archai.discrete_search.algos.evolution_pareto — INFO —  Crossover: 1 new models.
2023-03-29 19:46:09,632 - archai.discrete_search.algos.evolution_pareto — INFO —  Total unseen population: 29.
2023-03-29 19:46:09,632 - archai.discrete_search.algos.evolution_pareto — INFO —  Total unseen population after `max_unseen_population` restriction: 10.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>By default all algorithms will save the final pareto architectures <code class="docutils literal notranslate"><span class="pre">{output_dir}/pareto_models_iter_*/</span></code>, pareto evolution plots <code class="docutils literal notranslate"><span class="pre">pareto_*.png</span></code> and search state tables with all the results <code class="docutils literal notranslate"><span class="pre">{output_dir}/search_state_*.csv</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;./out_evo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;pareto_FLOPs_vs_Partial_training_Validation_Accuracy_1_epoch.png&#39;,
 &#39;pareto_models_iter_1&#39;,
 &#39;pareto_models_iter_2&#39;,
 &#39;pareto_models_iter_3&#39;,
 &#39;pareto_models_iter_4&#39;,
 &#39;pareto_models_iter_5&#39;,
 &#39;pareto_ONNX_Latency_ms_vs_FLOPs.png&#39;,
 &#39;pareto_ONNX_Latency_ms_vs_Partial_training_Validation_Accuracy_1_epoch.png&#39;,
 &#39;search_state_1.csv&#39;,
 &#39;search_state_2.csv&#39;,
 &#39;search_state_3.csv&#39;,
 &#39;search_state_4.csv&#39;,
 &#39;search_state_5.csv&#39;]
</pre></div></div>
</div>
<p>It is also possible to get information from the <code class="docutils literal notranslate"><span class="pre">search_results</span></code> object directly:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">search_results</span><span class="o">.</span><span class="n">plot_2d_pareto_evolution</span><span class="p">((</span><span class="s1">&#39;ONNX Latency (ms)&#39;</span><span class="p">,</span> <span class="s1">&#39;Partial training Validation Accuracy (1 epoch)&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../../_images/getting_started_notebooks_discrete_search_algos_61_0.png" src="../../../_images/getting_started_notebooks_discrete_search_algos_61_0.png" />
</div>
</div>
<p>We can get <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> object with the search results calling</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">search_results</span><span class="o">.</span><span class="n">get_search_state_df</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">results_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;is_pareto&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;is_pareto&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Partial training Validation Accuracy (1 epoch)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>archid</th>
      <th>ONNX Latency (ms)</th>
      <th>FLOPs</th>
      <th>Partial training Validation Accuracy (1 epoch)</th>
      <th>parent</th>
      <th>parents</th>
      <th>iteration_num</th>
      <th>search_walltime_hours</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>22</th>
      <td>L=1, K=5, H=16</td>
      <td>0.000067</td>
      <td>690250.0</td>
      <td>0.2366</td>
      <td>L=1, K=7, H=16</td>
      <td>None</td>
      <td>2</td>
      <td>0.283439</td>
    </tr>
    <tr>
      <th>5</th>
      <td>L=1, K=7, H=16</td>
      <td>0.000071</td>
      <td>1292362.0</td>
      <td>0.2929</td>
      <td>None</td>
      <td>None</td>
      <td>0</td>
      <td>0.060559</td>
    </tr>
    <tr>
      <th>36</th>
      <td>L=2, K=3, H=16</td>
      <td>0.000091</td>
      <td>3951690.0</td>
      <td>0.3045</td>
      <td>L=9, K=7, H=16</td>
      <td>None</td>
      <td>3</td>
      <td>0.414055</td>
    </tr>
    <tr>
      <th>2</th>
      <td>L=1, K=7, H=64</td>
      <td>0.000090</td>
      <td>5169418.0</td>
      <td>0.3303</td>
      <td>None</td>
      <td>None</td>
      <td>0</td>
      <td>0.060559</td>
    </tr>
    <tr>
      <th>16</th>
      <td>L=2, K=5, H=16</td>
      <td>0.000094</td>
      <td>10775626.0</td>
      <td>0.4510</td>
      <td>L=4, K=5, H=16</td>
      <td>None</td>
      <td>1</td>
      <td>0.142594</td>
    </tr>
    <tr>
      <th>13</th>
      <td>L=4, K=3, H=16</td>
      <td>0.000114</td>
      <td>11277386.0</td>
      <td>0.6514</td>
      <td>L=4, K=7, H=16</td>
      <td>None</td>
      <td>1</td>
      <td>0.142594</td>
    </tr>
    <tr>
      <th>21</th>
      <td>L=5, K=3, H=16</td>
      <td>0.000272</td>
      <td>14940234.0</td>
      <td>0.7085</td>
      <td>L=6, K=3, H=16</td>
      <td>None</td>
      <td>2</td>
      <td>0.283439</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L=6, K=3, H=16</td>
      <td>0.000133</td>
      <td>18603082.0</td>
      <td>0.7211</td>
      <td>None</td>
      <td>None</td>
      <td>0</td>
      <td>0.060559</td>
    </tr>
    <tr>
      <th>41</th>
      <td>L=3, K=5, H=16</td>
      <td>0.000117</td>
      <td>20861002.0</td>
      <td>0.7473</td>
      <td>None</td>
      <td>None</td>
      <td>4</td>
      <td>0.501170</td>
    </tr>
    <tr>
      <th>34</th>
      <td>L=8, K=3, H=16</td>
      <td>0.000153</td>
      <td>25928778.0</td>
      <td>0.8375</td>
      <td>L=4, K=3, H=16</td>
      <td>None</td>
      <td>3</td>
      <td>0.414055</td>
    </tr>
    <tr>
      <th>6</th>
      <td>L=4, K=5, H=16</td>
      <td>0.000129</td>
      <td>30946378.0</td>
      <td>0.8742</td>
      <td>None</td>
      <td>None</td>
      <td>0</td>
      <td>0.060559</td>
    </tr>
    <tr>
      <th>14</th>
      <td>L=3, K=7, H=16</td>
      <td>0.000398</td>
      <td>40730698.0</td>
      <td>0.9233</td>
      <td>None</td>
      <td>None</td>
      <td>1</td>
      <td>0.142594</td>
    </tr>
    <tr>
      <th>43</th>
      <td>L=5, K=5, H=16</td>
      <td>0.000170</td>
      <td>41031754.0</td>
      <td>0.9569</td>
      <td>L=9, K=5, H=32</td>
      <td>None</td>
      <td>4</td>
      <td>0.501170</td>
    </tr>
    <tr>
      <th>0</th>
      <td>L=4, K=7, H=16</td>
      <td>0.000189</td>
      <td>60449866.0</td>
      <td>0.9570</td>
      <td>None</td>
      <td>None</td>
      <td>0</td>
      <td>0.060559</td>
    </tr>
    <tr>
      <th>31</th>
      <td>L=7, K=5, H=16</td>
      <td>0.000200</td>
      <td>61202506.0</td>
      <td>0.9714</td>
      <td>L=4, K=5, H=16</td>
      <td>None</td>
      <td>3</td>
      <td>0.414055</td>
    </tr>
    <tr>
      <th>48</th>
      <td>L=9, K=5, H=16</td>
      <td>0.000227</td>
      <td>81373258.0</td>
      <td>0.9751</td>
      <td>None</td>
      <td>None</td>
      <td>4</td>
      <td>0.501170</td>
    </tr>
    <tr>
      <th>40</th>
      <td>L=10, K=5, H=16</td>
      <td>0.000244</td>
      <td>91458634.0</td>
      <td>0.9784</td>
      <td>L=10, K=7, H=16</td>
      <td>None</td>
      <td>4</td>
      <td>0.501170</td>
    </tr>
    <tr>
      <th>18</th>
      <td>L=9, K=7, H=16</td>
      <td>0.000363</td>
      <td>159045706.0</td>
      <td>0.9810</td>
      <td>L=1, K=7, H=16</td>
      <td>None</td>
      <td>1</td>
      <td>0.142594</td>
    </tr>
    <tr>
      <th>42</th>
      <td>L=6, K=5, H=32</td>
      <td>0.000372</td>
      <td>202586250.0</td>
      <td>0.9830</td>
      <td>L=6, K=3, H=16</td>
      <td>None</td>
      <td>4</td>
      <td>0.501170</td>
    </tr>
    <tr>
      <th>28</th>
      <td>L=10, K=7, H=16</td>
      <td>0.001076</td>
      <td>178764874.0</td>
      <td>0.9831</td>
      <td>L=4, K=7, H=16</td>
      <td>None</td>
      <td>2</td>
      <td>0.283439</td>
    </tr>
    <tr>
      <th>27</th>
      <td>L=9, K=5, H=32</td>
      <td>0.000537</td>
      <td>323309706.0</td>
      <td>0.9846</td>
      <td>None</td>
      <td>None</td>
      <td>2</td>
      <td>0.283439</td>
    </tr>
    <tr>
      <th>25</th>
      <td>L=7, K=3, H=64</td>
      <td>0.000623</td>
      <td>349176074.0</td>
      <td>0.9871</td>
      <td>L=1, K=7, H=16</td>
      <td>None</td>
      <td>2</td>
      <td>0.283439</td>
    </tr>
    <tr>
      <th>20</th>
      <td>L=7, K=7, H=32</td>
      <td>0.001266</td>
      <td>475242634.0</td>
      <td>0.9905</td>
      <td>None</td>
      <td>None</td>
      <td>2</td>
      <td>0.283439</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Since our search space is also compatible with Bayesian Optimization algorithms, let’s try more sophisticated algorithm like MO-BANANAS.</p>
<p>MO-BANANAS will progressively train a surrogate model based on the data gathered during search. This surrogate model will be used to predict the result of expensive objective function evaluations and will try to determine what are the best possible architectures according to the surrogate model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">archai.discrete_search.algos</span> <span class="kn">import</span> <span class="n">MoBananasSearch</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">algo2</span> <span class="o">=</span> <span class="n">MoBananasSearch</span><span class="p">(</span>
    <span class="n">ss</span><span class="p">,</span> <span class="n">objectives</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;./out_bananas&#39;</span><span class="p">,</span>
    <span class="n">num_iters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">mutations_per_parent</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">num_candidates</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">43</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">search_results2</span> <span class="o">=</span> <span class="n">algo2</span><span class="o">.</span><span class="n">search</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:46:12,111 - archai.discrete_search.algos.bananas — INFO —  Iteration 1/5
2023-03-29 19:46:12,112 - archai.discrete_search.algos.bananas — INFO —  Evaluating objectives for 10 architectures ...
2023-03-29 19:49:47,678 - archai.discrete_search.algos.bananas — INFO —  Updating surrogate model ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Training DNN Ensemble...: 100%|██████████| 5/5 [00:33&lt;00:00,  6.63s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:50:20,852 - archai.discrete_search.algos.bananas — INFO —  Generating mutations for 10 parent architectures ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:50:21,262 - archai.discrete_search.algos.bananas — INFO —  Found 36 new architectures satisfying constraints.
2023-03-29 19:50:21,263 - archai.discrete_search.algos.bananas — INFO —  Predicting [&#39;Partial training Validation Accuracy (1 epoch)&#39;] for new architectures using surrogate model ...
2023-03-29 19:50:21,267 - archai.discrete_search.algos.bananas — INFO —  Calculating cheap objectives [&#39;ONNX Latency (ms)&#39;, &#39;FLOPs&#39;] for new architectures ...
2023-03-29 19:50:22,452 - archai.discrete_search.algos.bananas — INFO —  Best 20 candidate architectures were selected for the next iteration.
2023-03-29 19:50:22,811 - archai.discrete_search.algos.bananas — INFO —  Iteration 2/5
2023-03-29 19:50:22,812 - archai.discrete_search.algos.bananas — INFO —  Evaluating objectives for 20 architectures ...
2023-03-29 19:55:31,589 - archai.discrete_search.algos.bananas — INFO —  Updating surrogate model ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Training DNN Ensemble...: 100%|██████████| 5/5 [00:34&lt;00:00,  6.83s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:56:05,762 - archai.discrete_search.algos.bananas — INFO —  Generating mutations for 10 parent architectures ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 19:56:06,143 - archai.discrete_search.algos.bananas — INFO —  Found 28 new architectures satisfying constraints.
2023-03-29 19:56:06,143 - archai.discrete_search.algos.bananas — INFO —  Predicting [&#39;Partial training Validation Accuracy (1 epoch)&#39;] for new architectures using surrogate model ...
2023-03-29 19:56:06,147 - archai.discrete_search.algos.bananas — INFO —  Calculating cheap objectives [&#39;ONNX Latency (ms)&#39;, &#39;FLOPs&#39;] for new architectures ...
2023-03-29 19:56:06,770 - archai.discrete_search.algos.bananas — INFO —  Best 20 candidate architectures were selected for the next iteration.
2023-03-29 19:56:07,170 - archai.discrete_search.algos.bananas — INFO —  Iteration 3/5
2023-03-29 19:56:07,170 - archai.discrete_search.algos.bananas — INFO —  Evaluating objectives for 20 architectures ...
2023-03-29 20:01:57,750 - archai.discrete_search.algos.bananas — INFO —  Updating surrogate model ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Training DNN Ensemble...: 100%|██████████| 5/5 [00:31&lt;00:00,  6.28s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 20:02:29,188 - archai.discrete_search.algos.bananas — INFO —  Generating mutations for 10 parent architectures ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 20:02:29,521 - archai.discrete_search.algos.bananas — INFO —  Found 11 new architectures satisfying constraints.
2023-03-29 20:02:29,521 - archai.discrete_search.algos.bananas — INFO —  Predicting [&#39;Partial training Validation Accuracy (1 epoch)&#39;] for new architectures using surrogate model ...
2023-03-29 20:02:29,524 - archai.discrete_search.algos.bananas — INFO —  Calculating cheap objectives [&#39;ONNX Latency (ms)&#39;, &#39;FLOPs&#39;] for new architectures ...
2023-03-29 20:02:29,646 - archai.discrete_search.algos.bananas — INFO —  Best 20 candidate architectures were selected for the next iteration.
2023-03-29 20:02:30,084 - archai.discrete_search.algos.bananas — INFO —  Iteration 4/5
2023-03-29 20:02:30,084 - archai.discrete_search.algos.bananas — INFO —  Evaluating objectives for 11 architectures ...
2023-03-29 20:09:48,369 - archai.discrete_search.algos.bananas — INFO —  Updating surrogate model ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Training DNN Ensemble...: 100%|██████████| 5/5 [00:31&lt;00:00,  6.32s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 20:10:19,986 - archai.discrete_search.algos.bananas — INFO —  Generating mutations for 10 parent architectures ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 20:10:20,246 - archai.discrete_search.algos.bananas — INFO —  Found 5 new architectures satisfying constraints.
2023-03-29 20:10:20,247 - archai.discrete_search.algos.bananas — INFO —  Predicting [&#39;Partial training Validation Accuracy (1 epoch)&#39;] for new architectures using surrogate model ...
2023-03-29 20:10:20,251 - archai.discrete_search.algos.bananas — INFO —  Calculating cheap objectives [&#39;ONNX Latency (ms)&#39;, &#39;FLOPs&#39;] for new architectures ...
2023-03-29 20:10:20,252 - archai.discrete_search.algos.bananas — INFO —  Best 20 candidate architectures were selected for the next iteration.
2023-03-29 20:10:20,720 - archai.discrete_search.algos.bananas — INFO —  Iteration 5/5
2023-03-29 20:10:20,721 - archai.discrete_search.algos.bananas — INFO —  Evaluating objectives for 5 architectures ...
2023-03-29 20:10:20,723 - archai.discrete_search.algos.bananas — INFO —  Updating surrogate model ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Training DNN Ensemble...: 100%|██████████| 5/5 [00:33&lt;00:00,  6.77s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 20:10:54,613 - archai.discrete_search.algos.bananas — INFO —  Generating mutations for 10 parent architectures ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-03-29 20:10:54,880 - archai.discrete_search.algos.bananas — INFO —  Found 5 new architectures satisfying constraints.
2023-03-29 20:10:54,881 - archai.discrete_search.algos.bananas — INFO —  Predicting [&#39;Partial training Validation Accuracy (1 epoch)&#39;] for new architectures using surrogate model ...
2023-03-29 20:10:54,885 - archai.discrete_search.algos.bananas — INFO —  Calculating cheap objectives [&#39;ONNX Latency (ms)&#39;, &#39;FLOPs&#39;] for new architectures ...
2023-03-29 20:10:54,945 - archai.discrete_search.algos.bananas — INFO —  Best 20 candidate architectures were selected for the next iteration.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;./out_bananas&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;pareto_FLOPs_vs_Partial_training_Validation_Accuracy_1_epoch.png&#39;,
 &#39;pareto_ONNX_Latency_ms_vs_FLOPs.png&#39;,
 &#39;pareto_ONNX_Latency_ms_vs_Partial_training_Validation_Accuracy_1_epoch.png&#39;,
 &#39;search_state_0.csv&#39;,
 &#39;search_state_1.csv&#39;,
 &#39;search_state_2.csv&#39;,
 &#39;search_state_3.csv&#39;,
 &#39;search_state_4.csv&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">search_results2</span><span class="o">.</span><span class="n">plot_2d_pareto_evolution</span><span class="p">((</span><span class="s1">&#39;ONNX Latency (ms)&#39;</span><span class="p">,</span> <span class="s1">&#39;Partial training Validation Accuracy (1 epoch)&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../../_images/getting_started_notebooks_discrete_search_algos_70_0.png" src="../../../_images/getting_started_notebooks_discrete_search_algos_70_0.png" />
</div>
</div>
<p>MO-BANANAS will also save the predictive mean and variance of the expensive objectives during that iteration .</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">results_df2</span> <span class="o">=</span> <span class="n">search_results2</span><span class="o">.</span><span class="n">get_search_state_df</span><span class="p">()</span>
<span class="n">results_df2</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;is_pareto&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Partial training Validation Accuracy (1 epoch)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;is_pareto&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>archid</th>
      <th>ONNX Latency (ms)</th>
      <th>FLOPs</th>
      <th>Partial training Validation Accuracy (1 epoch)</th>
      <th>iteration_num</th>
      <th>Predicted Partial training Validation Accuracy (1 epoch) mean</th>
      <th>Predicted Partial training Validation Accuracy (1 epoch) var</th>
      <th>search_walltime_hours</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14</th>
      <td>L=1, K=3, H=16</td>
      <td>0.000059</td>
      <td>288842.0</td>
      <td>0.2225</td>
      <td>1</td>
      <td>0.475666</td>
      <td>0.002211</td>
      <td>0.155478</td>
    </tr>
    <tr>
      <th>42</th>
      <td>L=1, K=5, H=16</td>
      <td>0.000067</td>
      <td>690250.0</td>
      <td>0.2366</td>
      <td>2</td>
      <td>0.245449</td>
      <td>0.000204</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>32</th>
      <td>L=1, K=3, H=32</td>
      <td>0.000075</td>
      <td>577674.0</td>
      <td>0.2473</td>
      <td>2</td>
      <td>0.260814</td>
      <td>0.000564</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>34</th>
      <td>L=1, K=3, H=64</td>
      <td>0.000076</td>
      <td>1155338.0</td>
      <td>0.2483</td>
      <td>2</td>
      <td>0.535216</td>
      <td>0.015243</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>22</th>
      <td>L=1, K=7, H=16</td>
      <td>0.000071</td>
      <td>1292362.0</td>
      <td>0.2929</td>
      <td>1</td>
      <td>0.299682</td>
      <td>0.002974</td>
      <td>0.155478</td>
    </tr>
    <tr>
      <th>46</th>
      <td>L=2, K=3, H=16</td>
      <td>0.000091</td>
      <td>3951690.0</td>
      <td>0.3045</td>
      <td>2</td>
      <td>0.312893</td>
      <td>0.000101</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>15</th>
      <td>L=1, K=7, H=64</td>
      <td>0.000090</td>
      <td>5169418.0</td>
      <td>0.3303</td>
      <td>1</td>
      <td>0.602266</td>
      <td>0.005785</td>
      <td>0.155478</td>
    </tr>
    <tr>
      <th>20</th>
      <td>L=3, K=3, H=16</td>
      <td>0.000105</td>
      <td>7614538.0</td>
      <td>0.4167</td>
      <td>1</td>
      <td>0.587572</td>
      <td>0.000149</td>
      <td>0.155478</td>
    </tr>
    <tr>
      <th>55</th>
      <td>L=2, K=5, H=16</td>
      <td>0.000094</td>
      <td>10775626.0</td>
      <td>0.4510</td>
      <td>3</td>
      <td>0.446544</td>
      <td>0.000443</td>
      <td>0.393473</td>
    </tr>
    <tr>
      <th>5</th>
      <td>L=4, K=3, H=16</td>
      <td>0.000114</td>
      <td>11277386.0</td>
      <td>0.6514</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.059947</td>
    </tr>
    <tr>
      <th>0</th>
      <td>L=5, K=3, H=16</td>
      <td>0.000272</td>
      <td>14940234.0</td>
      <td>0.7085</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.059947</td>
    </tr>
    <tr>
      <th>24</th>
      <td>L=6, K=3, H=16</td>
      <td>0.000133</td>
      <td>18603082.0</td>
      <td>0.7211</td>
      <td>1</td>
      <td>0.799245</td>
      <td>0.000174</td>
      <td>0.155478</td>
    </tr>
    <tr>
      <th>47</th>
      <td>L=3, K=5, H=16</td>
      <td>0.000117</td>
      <td>20861002.0</td>
      <td>0.7473</td>
      <td>2</td>
      <td>0.543294</td>
      <td>0.001922</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>23</th>
      <td>L=7, K=3, H=16</td>
      <td>0.000144</td>
      <td>22265930.0</td>
      <td>0.7538</td>
      <td>1</td>
      <td>0.886456</td>
      <td>0.000576</td>
      <td>0.155478</td>
    </tr>
    <tr>
      <th>17</th>
      <td>L=9, K=3, H=16</td>
      <td>0.000147</td>
      <td>29591626.0</td>
      <td>0.7907</td>
      <td>1</td>
      <td>0.979098</td>
      <td>0.000137</td>
      <td>0.155478</td>
    </tr>
    <tr>
      <th>31</th>
      <td>L=8, K=3, H=16</td>
      <td>0.000153</td>
      <td>25928778.0</td>
      <td>0.8375</td>
      <td>2</td>
      <td>0.773204</td>
      <td>0.000014</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>30</th>
      <td>L=4, K=5, H=16</td>
      <td>0.000129</td>
      <td>30946378.0</td>
      <td>0.8742</td>
      <td>2</td>
      <td>0.763225</td>
      <td>0.000907</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>45</th>
      <td>L=3, K=7, H=16</td>
      <td>0.000398</td>
      <td>40730698.0</td>
      <td>0.9233</td>
      <td>2</td>
      <td>0.725047</td>
      <td>0.001580</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>41</th>
      <td>L=6, K=5, H=16</td>
      <td>0.000167</td>
      <td>51117130.0</td>
      <td>0.9536</td>
      <td>2</td>
      <td>0.953731</td>
      <td>0.000092</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>38</th>
      <td>L=5, K=5, H=16</td>
      <td>0.000170</td>
      <td>41031754.0</td>
      <td>0.9569</td>
      <td>2</td>
      <td>0.906938</td>
      <td>0.000563</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>51</th>
      <td>L=4, K=7, H=16</td>
      <td>0.000189</td>
      <td>60449866.0</td>
      <td>0.9570</td>
      <td>3</td>
      <td>0.971134</td>
      <td>0.000025</td>
      <td>0.393473</td>
    </tr>
    <tr>
      <th>28</th>
      <td>L=7, K=3, H=32</td>
      <td>0.000193</td>
      <td>87883914.0</td>
      <td>0.9673</td>
      <td>1</td>
      <td>0.972595</td>
      <td>0.000003</td>
      <td>0.155478</td>
    </tr>
    <tr>
      <th>2</th>
      <td>L=7, K=5, H=16</td>
      <td>0.000200</td>
      <td>61202506.0</td>
      <td>0.9714</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.059947</td>
    </tr>
    <tr>
      <th>57</th>
      <td>L=9, K=5, H=16</td>
      <td>0.000227</td>
      <td>81373258.0</td>
      <td>0.9751</td>
      <td>3</td>
      <td>0.967726</td>
      <td>0.000004</td>
      <td>0.393473</td>
    </tr>
    <tr>
      <th>25</th>
      <td>L=10, K=5, H=16</td>
      <td>0.000244</td>
      <td>91458634.0</td>
      <td>0.9784</td>
      <td>1</td>
      <td>1.006564</td>
      <td>0.000043</td>
      <td>0.155478</td>
    </tr>
    <tr>
      <th>53</th>
      <td>L=10, K=3, H=32</td>
      <td>0.000275</td>
      <td>131537034.0</td>
      <td>0.9792</td>
      <td>3</td>
      <td>0.977563</td>
      <td>0.000043</td>
      <td>0.393473</td>
    </tr>
    <tr>
      <th>6</th>
      <td>L=7, K=7, H=16</td>
      <td>0.000287</td>
      <td>119607370.0</td>
      <td>0.9793</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.059947</td>
    </tr>
    <tr>
      <th>65</th>
      <td>L=9, K=7, H=16</td>
      <td>0.000363</td>
      <td>159045706.0</td>
      <td>0.9810</td>
      <td>4</td>
      <td>0.941756</td>
      <td>0.000016</td>
      <td>0.402460</td>
    </tr>
    <tr>
      <th>63</th>
      <td>L=4, K=7, H=32</td>
      <td>0.000436</td>
      <td>238913674.0</td>
      <td>0.9822</td>
      <td>4</td>
      <td>0.980534</td>
      <td>0.000009</td>
      <td>0.402460</td>
    </tr>
    <tr>
      <th>54</th>
      <td>L=8, K=5, H=32</td>
      <td>0.000402</td>
      <td>283068554.0</td>
      <td>0.9863</td>
      <td>3</td>
      <td>0.966136</td>
      <td>0.000119</td>
      <td>0.393473</td>
    </tr>
    <tr>
      <th>35</th>
      <td>L=7, K=3, H=64</td>
      <td>0.000623</td>
      <td>349176074.0</td>
      <td>0.9871</td>
      <td>2</td>
      <td>0.993294</td>
      <td>0.000136</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>36</th>
      <td>L=9, K=3, H=64</td>
      <td>0.000615</td>
      <td>465182986.0</td>
      <td>0.9879</td>
      <td>2</td>
      <td>1.016683</td>
      <td>0.000396</td>
      <td>0.262745</td>
    </tr>
    <tr>
      <th>58</th>
      <td>L=10, K=3, H=64</td>
      <td>0.000810</td>
      <td>523186442.0</td>
      <td>0.9889</td>
      <td>3</td>
      <td>0.994421</td>
      <td>0.000030</td>
      <td>0.393473</td>
    </tr>
    <tr>
      <th>7</th>
      <td>L=10, K=7, H=32</td>
      <td>0.001719</td>
      <td>711571594.0</td>
      <td>0.9896</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.059947</td>
    </tr>
    <tr>
      <th>19</th>
      <td>L=7, K=5, H=64</td>
      <td>0.001365</td>
      <td>967344394.0</td>
      <td>0.9915</td>
      <td>1</td>
      <td>1.019391</td>
      <td>0.000440</td>
      <td>0.155478</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Let’s use <a class="reference external" href="https://plotly.com/">plotly</a> to compare the final pareto frontiers of both algorithms:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="o">%</span><span class="k">pip</span> install plotly

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="n">merged_results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">results_df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">algo</span><span class="o">=</span><span class="s1">&#39;Evolution Pareto&#39;</span><span class="p">),</span>
    <span class="n">results_df2</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">algo</span><span class="o">=</span><span class="s1">&#39;Mo-BANANAS&#39;</span><span class="p">)</span>
<span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">merged_results_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;is_pareto&#39;</span><span class="p">),</span>
    <span class="s1">&#39;ONNX Latency (ms)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Partial training Validation Accuracy (1 epoch)&#39;</span><span class="p">,</span>
    <span class="n">hover_name</span><span class="o">=</span><span class="s1">&#39;archid&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;algo&#39;</span><span class="p">,</span>
    <span class="n">facet_col</span><span class="o">=</span><span class="s1">&#39;algo&#39;</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Requirement already satisfied: plotly in d:\anaconda3\envs\archai\lib\site-packages (5.13.0)
Requirement already satisfied: tenacity&gt;=6.2.0 in d:\anaconda3\envs\archai\lib\site-packages (from plotly) (8.2.1)
Note: you may need to restart the kernel to use updated packages.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
<p>You can get much faster search times using Azure ML with partial training happening in parallel across a GPU cluster. See the <a class="reference external" href="https://microsoft.github.io/archai/advanced_guide/cloud/azure/notebooks/multi_node_search/multi_node_search.html">Advanced Guide, Cloud-Based, Azure, Multi node search</a> example for details.</p>
</section>
<section id="Troubleshooting">
<h3>Troubleshooting<a class="headerlink" href="#Troubleshooting" title="Permalink to this headline">#</a></h3>
<p><strong>OMP: Error #15: Initializing libiomp5md.dll, but found libiomp5md.dll already initialized.</strong></p>
<p>This error might happen on Windows if your python environment has multiple version of this <code class="docutils literal notranslate"><span class="pre">libiomp5md.dll</span></code> in different locations, for example, one in <code class="docutils literal notranslate"><span class="pre">~\Library\bin</span></code> and another in <code class="docutils literal notranslate"><span class="pre">Lib\site-packages\torch\lib</span></code>. To resolve this copy the newest one over the older one so that the same dll is found in both places.</p>
</section>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="evaluators.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Evaluators</p>
      </div>
    </a>
    <a class="right-next"
       href="config_search.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Config Search Spaces</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Sections
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Dataset-Provider">Dataset Provider</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Wrapping-custom-evaluation-code">Wrapping custom evaluation code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Defining-Search-Objectives">Defining Search Objectives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-objectives">Adding objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Adding-extra-constraints">Adding extra constraints</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Using-a-search-algorithm">Using a search algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Example:-EvolutionParetoSearch">Example: <code class="docutils literal notranslate"><span class="pre">EvolutionParetoSearch</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Troubleshooting">Troubleshooting</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Microsoft
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Apr 04, 2023.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>