{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "d6fa8b24",
   "metadata": {},
   "source": [
    "# Search Algorithms"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "1b103993",
   "metadata": {},
   "outputs": [],
   "source": [
    "from overrides import overrides\n",
    "import torch\n",
    "from torch import nn\n",
    "import numpy as np\n",
    "import json\n",
    "from typing import Tuple\n",
    "from random import Random\n",
    "\n",
    "from typing import Tuple, List, Optional\n",
    "from archai.discrete_search import ArchaiModel, EvolutionarySearchSpace, BayesOptSearchSpace"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f81488a6",
   "metadata": {},
   "source": [
    "We will re-use the CNN search space created in the [search space example](./search_space.ipynb)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "9b7ac3c7",
   "metadata": {
    "nbsphinx": "hidden"
   },
   "outputs": [],
   "source": [
    "class MyModel(nn.Module):\n",
    "    def __init__(self, nb_layers: int = 5, kernel_size: int = 3, hidden_dim: int = 32):\n",
    "        super().__init__()\n",
    "        \n",
    "        self.nb_layers = nb_layers\n",
    "        self.kernel_size = kernel_size\n",
    "        self.hidden_dim = hidden_dim\n",
    "        \n",
    "        layer_list = []\n",
    "\n",
    "        for i in range(nb_layers):\n",
    "            in_ch = (1 if i == 0 else hidden_dim)\n",
    "            \n",
    "            layer_list += [\n",
    "                nn.Conv2d(in_ch, hidden_dim, kernel_size=kernel_size, padding=(kernel_size-1)//2),\n",
    "                nn.BatchNorm2d(hidden_dim),\n",
    "                nn.ReLU(),\n",
    "            ]\n",
    "            \n",
    "        layer_list += [\n",
    "            nn.AdaptiveAvgPool2d(output_size=(1, 1)),\n",
    "            nn.Conv2d(hidden_dim, 10, kernel_size=1)\n",
    "        ]\n",
    "\n",
    "        self.model = nn.Sequential(*layer_list)\n",
    "    \n",
    "    def forward(self, x):\n",
    "        return self.model(x).squeeze()\n",
    "    \n",
    "    def get_archid(self):\n",
    "        return f'({self.nb_layers}, {self.kernel_size}, {self.hidden_dim})'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "9580e53f",
   "metadata": {
    "nbsphinx": "hidden"
   },
   "outputs": [],
   "source": [
    "class CNNSearchSpace(EvolutionarySearchSpace, BayesOptSearchSpace):\n",
    "    def __init__(self, min_layers: int = 1, max_layers: int = 12,\n",
    "                 kernel_list=(1, 3, 5, 7), hidden_list=(16, 32, 64, 128),\n",
    "                 seed: int = 1):\n",
    "\n",
    "        self.min_layers = min_layers\n",
    "        self.max_layers = max_layers\n",
    "        self.kernel_list = kernel_list\n",
    "        self.hidden_list = hidden_list\n",
    "        \n",
    "        self.rng = Random(seed)\n",
    "        \n",
    "    @overrides\n",
    "    def random_sample(self) -> ArchaiModel:\n",
    "        # Randomly chooses architecture parameters\n",
    "        nb_layers = self.rng.randint(self.min_layers, self.max_layers)\n",
    "        kernel_size = self.rng.choice(self.kernel_list)\n",
    "        hidden_dim = self.rng.choice(self.hidden_list)\n",
    "        \n",
    "        model = MyModel(nb_layers, kernel_size, hidden_dim)\n",
    "        \n",
    "        # Wraps model into ArchaiModel\n",
    "        return ArchaiModel(arch=model, archid=model.get_archid())\n",
    "\n",
    "    @overrides\n",
    "    def save_arch(self, model: ArchaiModel, file: str):\n",
    "        with open(file, 'w') as fp:\n",
    "            json.dump({\n",
    "                'nb_layers': model.arch.nb_layers,\n",
    "                'kernel_size': model.arch.kernel_size,\n",
    "                'hidden_dim': model.arch.hidden_dim\n",
    "            }, fp)\n",
    "\n",
    "    @overrides\n",
    "    def load_arch(self, file: str):\n",
    "        config = json.load(open(file))\n",
    "        model = MyModel(**config)\n",
    "        \n",
    "        return ArchaiModel(arch=model, archid=model.get_archid())\n",
    "\n",
    "    @overrides\n",
    "    def save_model_weights(self, model: ArchaiModel, file: str):\n",
    "        state_dict = model.arch.get_state_dict()\n",
    "        torch.save(state_dict, file)\n",
    "    \n",
    "    @overrides\n",
    "    def load_model_weights(self, model: ArchaiModel, file: str):\n",
    "        model.arch.load_state_dict(torch.load(file))\n",
    "\n",
    "    @overrides\n",
    "    def mutate(self, model_1: ArchaiModel) -> ArchaiModel:\n",
    "        config = {\n",
    "            'nb_layers': model_1.arch.nb_layers,\n",
    "            'kernel_size': model_1.arch.kernel_size,\n",
    "            'hidden_dim': model_1.arch.hidden_dim\n",
    "        }\n",
    "        \n",
    "        if self.rng.random() < 0.2:\n",
    "            config['nb_layers'] = self.rng.randint(self.min_layers, self.max_layers)\n",
    "        \n",
    "        if self.rng.random() < 0.2:\n",
    "            config['kernel_size'] = self.rng.choice(self.kernel_list)\n",
    "        \n",
    "        if self.rng.random() < 0.2:\n",
    "            config['hidden_dim'] = self.rng.choice(self.hidden_list)\n",
    "        \n",
    "        mutated_model = MyModel(**config)\n",
    "        \n",
    "        return ArchaiModel(\n",
    "            arch=mutated_model, archid=mutated_model.get_archid()\n",
    "        )\n",
    "    \n",
    "    @overrides\n",
    "    def crossover(self, model_list: List[ArchaiModel]) -> ArchaiModel:\n",
    "        model_1, model_2 = model_list[:2]\n",
    "        \n",
    "        new_config = {\n",
    "            'nb_layers': self.rng.choice([model_1.arch.nb_layers, model_2.arch.nb_layers]),\n",
    "            'kernel_size': self.rng.choice([model_1.arch.kernel_size, model_2.arch.kernel_size]),\n",
    "            'hidden_dim': self.rng.choice([model_1.arch.hidden_dim, model_2.arch.hidden_dim]),\n",
    "        }\n",
    "        \n",
    "        crossover_model = MyModel(**new_config)\n",
    "        \n",
    "        return ArchaiModel(\n",
    "            arch=crossover_model, archid=crossover_model.get_archid()\n",
    "        )\n",
    "    \n",
    "    @overrides\n",
    "    def encode(self, model: ArchaiModel) -> np.ndarray:\n",
    "        return np.array([model.arch.nb_layers, model.arch.kernel_size, model.arch.hidden_dim])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "d2a667bb",
   "metadata": {},
   "outputs": [],
   "source": [
    "ss = CNNSearchSpace(max_layers=10, kernel_list=[3, 5, 7], hidden_list=[32, 64, 128])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "b7b5dd4e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ArchaiModel(\n",
       "\tarchid=(3, 7, 32), \n",
       "\tmetadata={}, \n",
       "\tarch=MyModel(\n",
       "  (model): Sequential(\n",
       "    (0): Conv2d(1, 32, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3))\n",
       "    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "    (2): ReLU()\n",
       "    (3): Conv2d(32, 32, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3))\n",
       "    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "    (5): ReLU()\n",
       "    (6): Conv2d(32, 32, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3))\n",
       "    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "    (8): ReLU()\n",
       "    (9): AdaptiveAvgPool2d(output_size=(1, 1))\n",
       "    (10): Conv2d(32, 10, kernel_size=(1, 1), stride=(1, 1))\n",
       "  )\n",
       ")\n",
       ")"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "m = ss.random_sample()\n",
    "m"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "24de6e98",
   "metadata": {},
   "source": [
    "## Dataset Provider"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6cf68260",
   "metadata": {},
   "source": [
    "Datasets are represented in Archai throught the [`DatasetProvider`](../../reference/api/archai.discrete_search.api.rst) class. For this example, we will use the built-in dataset provider of the MNIST dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "dc94c3d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "from pathlib import Path\n",
    "from archai.cv.datasets.providers.mnist_provider import MnistProvider"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "058373ec",
   "metadata": {},
   "outputs": [],
   "source": [
    "dataset_provider = MnistProvider({'dataroot': Path.home() / 'dataroot'})"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "67e836d0",
   "metadata": {},
   "source": [
    "We can get train/test PyTorch datasets from a DatasetProvider by calling `dataset_provider.get_datasets(load_train, load_test, transforms_train, transforms_test)`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "10505074",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Loads only the training set\n",
    "tr_d, _ = dataset_provider.get_datasets(load_train=True, load_test=False, transform_train=None, transform_test=None)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ecace173",
   "metadata": {},
   "source": [
    "## Wrapping custom evaluation code"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "056973d6",
   "metadata": {},
   "source": [
    "We will evaluate our models using partial trainig validation accuracy as a proxy for final task performance. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "df253354",
   "metadata": {},
   "outputs": [],
   "source": [
    "from archai.discrete_search import ModelEvaluator\n",
    "from archai.discrete_search.evaluators.ray import RayParallelEvaluator\n",
    "\n",
    "from torchvision.transforms import Compose, ToTensor, Normalize\n",
    "from tqdm import tqdm\n",
    "import math\n",
    "\n",
    "\n",
    "class PartialTrainingValAccuracy(ModelEvaluator):\n",
    "    def __init__(self, training_epochs: float = 1.0, lr: float = 1e-4, device: str = 'cpu',\n",
    "                 progress_bar: bool = False):\n",
    "        self.training_epochs = training_epochs\n",
    "        self.device = device\n",
    "        self.lr = lr\n",
    "        self.preprocess = ToTensor()\n",
    "        self.progress_bar = progress_bar\n",
    "    \n",
    "    @overrides\n",
    "    def evaluate(self, model, dataset_provider, budget = None) -> float:\n",
    "        # Loads the dataset\n",
    "        tr_data, _ = dataset_provider.get_datasets(True, False, self.preprocess, None)\n",
    "        \n",
    "        # Train-validation split\n",
    "        tr_data, val_data = torch.utils.data.random_split(\n",
    "            tr_data, lengths=[len(tr_data) - 1_000, 1_000], \n",
    "            generator=torch.Generator().manual_seed(42)\n",
    "        )\n",
    "        \n",
    "        tr_dl = torch.utils.data.DataLoader(tr_data, batch_size=16, shuffle=True, num_workers=4)\n",
    "        val_dl = torch.utils.data.DataLoader(val_data, batch_size=16, shuffle=False, num_workers=4)\n",
    "        \n",
    "        # Training settings\n",
    "        optimizer = torch.optim.Adam(model.arch.parameters(), lr=self.lr)\n",
    "        criterion = nn.CrossEntropyLoss()\n",
    "        \n",
    "        model.arch.train()\n",
    "        model.arch.to(self.device)\n",
    "        \n",
    "        # Partial training\n",
    "        epoch_iter = range(math.ceil(self.training_epochs))\n",
    "        if self.progress_bar:\n",
    "            epoch_iter = tqdm(epoch_iter, desc=f'Training model {model.archid}')\n",
    "\n",
    "        for epoch_nb in epoch_iter:\n",
    "            # Early stops for fractional values of training epochs (e.g, 0.2)\n",
    "            early_stop = len(tr_dl) + 1\n",
    "            if 0 < (self.training_epochs - epoch_nb) < 1:\n",
    "                early_stop = int((self.training_epochs - epoch_nb) * len(tr_dl))\n",
    "            \n",
    "            for i, (x, y) in enumerate(tr_dl):\n",
    "                if i >= early_stop:\n",
    "                    break\n",
    "                \n",
    "                optimizer.zero_grad()\n",
    "                \n",
    "                pred = model.arch(x.to(self.device))\n",
    "                loss = criterion(pred, y.to(self.device))\n",
    "\n",
    "                loss.backward()\n",
    "                optimizer.step()\n",
    "        \n",
    "        # Evaluates final model\n",
    "        model.arch.eval()\n",
    "        \n",
    "        with torch.no_grad():\n",
    "            val_pred, val_target = [], []\n",
    "\n",
    "            for x, y in val_dl:\n",
    "                val_pred.append(model.arch(x.to(self.device)).argmax(axis=1).to('cpu'))\n",
    "                val_target.append(y.to('cpu'))\n",
    "\n",
    "            val_pred, val_target = torch.cat(val_pred, axis=0), torch.cat(val_target, axis=0)\n",
    "            val_acc = (val_pred.squeeze() == val_target.squeeze()).numpy().mean()\n",
    "\n",
    "        # Returns model to cpu\n",
    "        model.arch.cpu()\n",
    "        \n",
    "        return val_acc"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "19a74a59",
   "metadata": {},
   "source": [
    "Let's test our evaluator:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "7e40e515",
   "metadata": {},
   "outputs": [],
   "source": [
    "partial_tr = PartialTrainingValAccuracy(training_epochs=0.001, progress_bar=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "689a2adf",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Training model (5, 3, 64): 100%|██████████| 1/1 [00:00<00:00,  2.49it/s]\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "0.088"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "partial_tr.evaluate(ss.random_sample(), dataset_provider)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7d6e6884",
   "metadata": {},
   "source": [
    "We can make this objective more efficient evaluating multiple architectures in parallel. To do that, we can use the `RayParallelObjective` wrapper mentioned in the [previous example](./objectives.ipynb):"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "f88c234b",
   "metadata": {},
   "outputs": [],
   "source": [
    "parallel_partial_tr = RayParallelEvaluator(partial_tr)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eaa3c2a5",
   "metadata": {},
   "source": [
    "Let's test our partial training objective sending two random architectures"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "4adfc19b",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2023-01-10 16:51:28,677\tINFO worker.py:1518 -- Started a local Ray instance.\n"
     ]
    }
   ],
   "source": [
    "# NBVAL_SKIP\n",
    "parallel_partial_tr.send(ss.random_sample(), dataset_provider)\n",
    "parallel_partial_tr.send(ss.random_sample(), dataset_provider)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "a974a2b7",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Training model (7, 3, 32):   0%|          | 0/1 [00:00<?, ?it/s]\n",
      "Training model (8, 5, 128):   0%|          | 0/1 [00:00<?, ?it/s]\n",
      "Training model (7, 3, 32): 100%|██████████| 1/1 [00:00<00:00,  2.64it/s]\n",
      "Training model (8, 5, 128): 100%|██████████| 1/1 [00:07<00:00,  7.10s/it]\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[0.088, 0.088]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# NBVAL_SKIP\n",
    "parallel_partial_tr.fetch_all()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b3b548cb",
   "metadata": {},
   "source": [
    "To run the same objective distributing jobs across multiple GPUs, just set the `num_gpus` parameter from [ray.init](https://docs.ray.io/en/latest/ray-core/package-ref.html#ray-init):\n",
    "\n",
    "```python\n",
    "RayParallelObjective(\n",
    "    PartialTrainingValAccuracy(training_epochs=1),\n",
    "    num_gpus=0.5, # 2 jobs per gpu available\n",
    "    max_calls=1\n",
    ")\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3c50b818",
   "metadata": {},
   "source": [
    "## Defining Search Objectives"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7c8ac88d",
   "metadata": {},
   "source": [
    "Search optimization objectives are specified using the `archai.discrete_search.SearchObjectives` class"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "25095dc5",
   "metadata": {},
   "outputs": [],
   "source": [
    "from archai.discrete_search import SearchObjectives\n",
    "\n",
    "objectives = SearchObjectives()"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "id": "ccf6ddc3",
   "metadata": {},
   "source": [
    "### Adding objectives"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "id": "9950bb3b",
   "metadata": {},
   "source": [
    "To add search objectives, we can use the `SearchObjectives.add_objective` method\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "3060750e",
   "metadata": {},
   "outputs": [],
   "source": [
    "from archai.discrete_search.evaluators.onnx_model import AvgOnnxLatency\n",
    "from archai.discrete_search.evaluators.torch_profiler import TorchFlops, TorchNumParameters\n",
    "\n",
    "objectives.add_objective(\n",
    "    # This name will be used in plots and reports\n",
    "    name='ONNX Latency (ms)',  \n",
    "    \n",
    "    # This is the evaluator we want to use\n",
    "    model_evaluator=AvgOnnxLatency(input_shape=(1, 1, 28, 28), num_trials=3),  \n",
    "    \n",
    "    # Optimization direction. `True` for maximization or `False` for minimization\n",
    "    higher_is_better=False,\n",
    "\n",
    "    # Used to sinalized if this evaluator is compute intensive.\n",
    "    compute_intensive=False \n",
    ")\n"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "id": "92aaef34",
   "metadata": {},
   "source": [
    "The `compute_intensive` flag is used in some search algorithms to help increase search efficiency. For instance, search algorithms that use surrogate models may try to estimate the value of expensive objective functions of unseen architectures in certain situations, while cheap objectives (`compute_intensive=False`) will just be computed directly."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "4cd5163c",
   "metadata": {},
   "outputs": [],
   "source": [
    "objectives.add_objective(\n",
    "    'FLOPs', TorchFlops(sample_args=(torch.randn(1, 1, 28, 28),)),\n",
    "    higher_is_better=False,\n",
    "    compute_intensive=False,\n",
    "    # We may optionally add a constraint. \n",
    "    # Architectures outside this range will be ignored by the search algorithm\n",
    "    constraint=(0.0, 1e9)\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "41127aed",
   "metadata": {},
   "source": [
    "Additionally, objectives that are cheap to evaluate (`compute_intensive=False`) may receive an optional `constraint` argument. Model candidates outside this range will\n",
    "be ignored by the search algorithm."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8b058b47",
   "metadata": {},
   "source": [
    "We can evaluate cheap objectives calling `SearchObjectives.eval_cheap_objs(model_list, dataset_providers)`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "df60ad54",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Calculating \"ONNX Latency (ms)\"...: 100%|██████████| 2/2 [00:00<00:00,  4.44it/s]\n",
      "Calculating \"FLOPs\"...: 100%|██████████| 2/2 [00:00<00:00, 20.09it/s]\n",
      "Gathering results from async objectives...: 0it [00:00, ?it/s]\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "{'ONNX Latency (ms)': array([0.00098251, 0.00145262]),\n",
       " 'FLOPs': array([4.07179530e+08, 4.75242634e+08])}"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "objectives.eval_cheap_objs([ss.random_sample() for _ in range(2)], dataset_providers=None,\n",
    "                           progress_bar=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c7ae043b",
   "metadata": {},
   "source": [
    "We can check if a model satisfies the constraints we added for the FLOPs objective by calling `SearchObjectives.validate_constraints(model_list, dataset_providers)` or `SearchObjectives.is_model_valid(ss.random_sample(), dataset_provider)`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "e99203fa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "({'FLOPs': array([4.50410139e+09])}, array([], dtype=int64))"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "m = ss.random_sample()\n",
    "\n",
    "objectives.validate_constraints([m], dataset_providers=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "858a3966",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "False"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "objectives.is_model_valid(m, dataset_provider=None)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7ddc2911",
   "metadata": {},
   "source": [
    "By default, all objective and constraints evaluations are cached to prevent spending resources in the same architecture twice."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "fc3893e6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{('ONNX Latency (ms)', '(8, 3, 64)', 'NoneType', None): 0.0009825120214372873,\n",
       " ('ONNX Latency (ms)', '(7, 7, 32)', 'NoneType', None): 0.001452620994920532,\n",
       " ('FLOPs', '(8, 3, 64)', 'NoneType', None): 407179530,\n",
       " ('FLOPs', '(7, 7, 32)', 'NoneType', None): 475242634,\n",
       " ('FLOPs', '(8, 5, 128)', 'NoneType', None): 4504101386}"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# The evaluation cached is built\n",
    "# using the tuple (obj_name, archid, dataset provider name, budget)\n",
    "objectives.cache"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1fbcc6c7",
   "metadata": {},
   "source": [
    "Caching can be disabled setting `SearchObjectives(cache_objective_evaluation=False)`."
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "id": "ee596afe",
   "metadata": {},
   "source": [
    "Now, let's add the partial training objective we created before"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "50c463da",
   "metadata": {},
   "outputs": [],
   "source": [
    "objectives.add_objective(\n",
    "    'Partial training Validation Accuracy (1 epoch)',\n",
    "    RayParallelEvaluator(\n",
    "        PartialTrainingValAccuracy(training_epochs=1, device='cuda'),\n",
    "        num_gpus=0.5, # 2 jobs per gpu available\n",
    "        max_calls=1\n",
    "    ),\n",
    "    higher_is_better=True,\n",
    "    compute_intensive=True # This is a compute intensive evaluator\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "33bfae1a",
   "metadata": {},
   "source": [
    "Expensive objectives can be evaluated using `SearchObjectives.eval_expensive_objs(model_list, dataset_providers)`"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f2ec34f6",
   "metadata": {},
   "source": [
    "Alternatively, all objectives (expensive and cheap) can also be evaluated using `SearchObjectives.eval_all_objs`."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "91205ae4",
   "metadata": {},
   "source": [
    "### Adding extra constraints"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ec0e1653",
   "metadata": {},
   "source": [
    "Besides the constraint parameter from cheap objectives, it is also possible to add extra constraints that are not search objectives (and thus should not be optimized by NAS algorithms)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "74cf95ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "from archai.discrete_search.evaluators.torch_profiler import TorchNumParameters\n",
    "\n",
    "objectives.add_constraint(\n",
    "    'Number of parameters',\n",
    "    TorchNumParameters(),\n",
    "    constraint=(0.0, 1e6)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "dc36366d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "({'Number of parameters': array([2874762.]), 'FLOPs': array([4.50410139e+09])},\n",
       " array([], dtype=int64))"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "objectives.validate_constraints([m], None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "27a83b39",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "False"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "objectives.is_model_valid(m, None)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ae8bd85d",
   "metadata": {},
   "source": [
    "## Using a search algorithm"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0a2a8fa7",
   "metadata": {},
   "source": [
    "Now that we know how to create and use search objectives, we can finally use a search algorithm do to Neural Architecture Search!"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "457800f2",
   "metadata": {},
   "source": [
    "### Example: `EvolutionParetoSearch`"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "81b60964",
   "metadata": {},
   "source": [
    "Let's start with an evolutionary-based search algorithm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "1b66c7e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "from archai.discrete_search.algos.evolution_pareto import EvolutionParetoSearch"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "d5bb8efe",
   "metadata": {},
   "outputs": [],
   "source": [
    "algo = EvolutionParetoSearch(\n",
    "    ss, objectives, dataset_provider, \n",
    "    output_dir='./out_evo',\n",
    "    num_iters=5, num_crossovers=5,\n",
    "    mutations_per_parent=2,\n",
    "    max_unseen_population=10\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "7b0d4117",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "13:56 Using 10 random architectures as the initial population\n",
      "13:56 starting evolution pareto iter 0\n",
      "13:56 iter 0: calculating search objectives ['ONNX Latency (ms)', 'FLOPs', 'Partial training Validation Accuracy (1 epoch)'] for 10 models\n",
      "13:57 iter 0: updating the pareto\n",
      "13:57 iter 0: found 7 members\n",
      "13:57 iter 0: chose 7 parents\n",
      "Mutating parents: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:00<00:00, 25.16it/s]\n",
      "13:57 iter 0: mutation yielded 12 new models\n",
      "13:57 iter 0: crossover yielded 1 new models\n",
      "13:57 iter 0: total unseen population 18\n",
      "13:57 iter 0: total unseen population after `max_unseen_population` restriction 10\n",
      "13:57 starting evolution pareto iter 1\n",
      "13:57 iter 1: calculating search objectives ['ONNX Latency (ms)', 'FLOPs', 'Partial training Validation Accuracy (1 epoch)'] for 10 models\n",
      "13:58 iter 1: updating the pareto\n",
      "13:58 iter 1: found 12 members\n",
      "13:58 iter 1: chose 12 parents\n",
      "Mutating parents: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.74it/s]\n",
      "13:58 iter 1: mutation yielded 15 new models\n",
      "13:58 iter 1: crossover yielded 0 new models\n",
      "13:58 iter 1: total unseen population 20\n",
      "13:58 iter 1: total unseen population after `max_unseen_population` restriction 10\n",
      "13:58 starting evolution pareto iter 2\n",
      "13:58 iter 2: calculating search objectives ['ONNX Latency (ms)', 'FLOPs', 'Partial training Validation Accuracy (1 epoch)'] for 10 models\n",
      "13:59 iter 2: updating the pareto\n",
      "13:59 iter 2: found 18 members\n",
      "13:59 iter 2: chose 18 parents\n",
      "Mutating parents: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18/18 [00:01<00:00, 15.72it/s]\n",
      "13:59 iter 2: mutation yielded 18 new models\n",
      "13:59 iter 2: crossover yielded 1 new models\n",
      "13:59 iter 2: total unseen population 24\n",
      "13:59 iter 2: total unseen population after `max_unseen_population` restriction 10\n",
      "13:59 starting evolution pareto iter 3\n",
      "13:59 iter 3: calculating search objectives ['ONNX Latency (ms)', 'FLOPs', 'Partial training Validation Accuracy (1 epoch)'] for 10 models\n",
      "14:00 iter 3: updating the pareto\n",
      "14:00 iter 3: found 20 members\n",
      "14:00 iter 3: chose 20 parents\n",
      "Mutating parents: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:00<00:00, 29.05it/s]\n",
      "14:00 iter 3: mutation yielded 21 new models\n",
      "14:00 iter 3: crossover yielded 2 new models\n",
      "14:00 iter 3: total unseen population 28\n",
      "14:00 iter 3: total unseen population after `max_unseen_population` restriction 10\n",
      "14:00 starting evolution pareto iter 4\n",
      "14:00 iter 4: calculating search objectives ['ONNX Latency (ms)', 'FLOPs', 'Partial training Validation Accuracy (1 epoch)'] for 10 models\n",
      "14:01 iter 4: updating the pareto\n",
      "14:01 iter 4: found 24 members\n",
      "14:01 iter 4: chose 24 parents\n",
      "Mutating parents: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 24/24 [00:00<00:00, 24.93it/s]\n",
      "14:01 iter 4: mutation yielded 17 new models\n",
      "14:01 iter 4: crossover yielded 1 new models\n",
      "14:01 iter 4: total unseen population 23\n",
      "14:01 iter 4: total unseen population after `max_unseen_population` restriction 10\n"
     ]
    }
   ],
   "source": [
    "# NBVAL_SKIP\n",
    "search_results = algo.search()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "44658a70",
   "metadata": {},
   "source": [
    "By default all algorithms will save the final pareto architectures `{output_dir}/pareto_models_iter_*/`, pareto evolution plots `pareto_*.png` and search state tables with all the results `{output_dir}/search_state_*.csv`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "248462b2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "log.log\r\n",
      "pareto_FLOPs_vs_Partial_training_Validation_Accuracy_1_epoch.png\r\n",
      "pareto_models_iter_1\r\n",
      "pareto_models_iter_2\r\n",
      "pareto_models_iter_3\r\n",
      "pareto_models_iter_4\r\n",
      "pareto_models_iter_5\r\n",
      "pareto_ONNX_Latency_ms_vs_FLOPs.png\r\n",
      "pareto_ONNX_Latency_ms_vs_Partial_training_Validation_Accuracy_1_epoch.png\r\n",
      "search_state_1.csv\r\n",
      "search_state_2.csv\r\n",
      "search_state_3.csv\r\n",
      "search_state_4.csv\r\n",
      "search_state_5.csv\r\n"
     ]
    }
   ],
   "source": [
    "# NBVAL_SKIP\n",
    "!ls ./out_evo"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "384e9a76",
   "metadata": {},
   "source": [
    "It is also possible to get information from the `search_results` object directly:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "2923ca7e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 720x360 with 2 Axes>"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# NBVAL_SKIP\n",
    "search_results.plot_2d_pareto_evolution(('ONNX Latency (ms)', 'Partial training Validation Accuracy (1 epoch)'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "169bdce1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>archid</th>\n",
       "      <th>Partial training Validation Accuracy (1 epoch)</th>\n",
       "      <th>ONNX Latency (ms)</th>\n",
       "      <th>FLOPs</th>\n",
       "      <th>parent</th>\n",
       "      <th>parents</th>\n",
       "      <th>iteration_num</th>\n",
       "      <th>Search walltime (hours)</th>\n",
       "      <th>is_pareto</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>(1, 3, 64)</td>\n",
       "      <td>0.264</td>\n",
       "      <td>0.000239</td>\n",
       "      <td>706762.0</td>\n",
       "      <td>(1, 7, 128)</td>\n",
       "      <td>None</td>\n",
       "      <td>4</td>\n",
       "      <td>0.086072</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>(1, 5, 32)</td>\n",
       "      <td>0.274</td>\n",
       "      <td>0.000251</td>\n",
       "      <td>754794.0</td>\n",
       "      <td>(1, 5, 128)</td>\n",
       "      <td>None</td>\n",
       "      <td>1</td>\n",
       "      <td>0.032674</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>(1, 7, 32)</td>\n",
       "      <td>0.310</td>\n",
       "      <td>0.000208</td>\n",
       "      <td>1356906.0</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "      <td>0.016957</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>(1, 7, 64)</td>\n",
       "      <td>0.326</td>\n",
       "      <td>0.000236</td>\n",
       "      <td>2713802.0</td>\n",
       "      <td>(9, 3, 64)</td>\n",
       "      <td>None</td>\n",
       "      <td>3</td>\n",
       "      <td>0.070278</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>(1, 5, 128)</td>\n",
       "      <td>0.335</td>\n",
       "      <td>0.000296</td>\n",
       "      <td>3019146.0</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "      <td>0.016957</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>(1, 7, 128)</td>\n",
       "      <td>0.385</td>\n",
       "      <td>0.000249</td>\n",
       "      <td>5427594.0</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "      <td>0.016957</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>(2, 3, 32)</td>\n",
       "      <td>0.456</td>\n",
       "      <td>0.000285</td>\n",
       "      <td>7679082.0</td>\n",
       "      <td>(9, 3, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>3</td>\n",
       "      <td>0.070278</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>(2, 3, 64)</td>\n",
       "      <td>0.569</td>\n",
       "      <td>0.000370</td>\n",
       "      <td>29808842.0</td>\n",
       "      <td>(2, 3, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>4</td>\n",
       "      <td>0.086072</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>(3, 3, 32)</td>\n",
       "      <td>0.710</td>\n",
       "      <td>0.000445</td>\n",
       "      <td>15004778.0</td>\n",
       "      <td>(6, 3, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>1</td>\n",
       "      <td>0.032674</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>(4, 3, 32)</td>\n",
       "      <td>0.829</td>\n",
       "      <td>0.000490</td>\n",
       "      <td>22330474.0</td>\n",
       "      <td>(6, 3, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>2</td>\n",
       "      <td>0.052575</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>(2, 7, 32)</td>\n",
       "      <td>0.886</td>\n",
       "      <td>0.000458</td>\n",
       "      <td>40795242.0</td>\n",
       "      <td>(9, 7, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>2</td>\n",
       "      <td>0.052575</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>(5, 3, 32)</td>\n",
       "      <td>0.922</td>\n",
       "      <td>0.000627</td>\n",
       "      <td>29656170.0</td>\n",
       "      <td>(4, 3, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>3</td>\n",
       "      <td>0.070278</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>(3, 5, 32)</td>\n",
       "      <td>0.946</td>\n",
       "      <td>0.000479</td>\n",
       "      <td>41096298.0</td>\n",
       "      <td>(3, 3, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>2</td>\n",
       "      <td>0.052575</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>(6, 3, 32)</td>\n",
       "      <td>0.949</td>\n",
       "      <td>0.000722</td>\n",
       "      <td>36981866.0</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "      <td>0.016957</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>(7, 3, 32)</td>\n",
       "      <td>0.956</td>\n",
       "      <td>0.000851</td>\n",
       "      <td>44307562.0</td>\n",
       "      <td>(9, 3, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>2</td>\n",
       "      <td>0.052575</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>(4, 5, 32)</td>\n",
       "      <td>0.974</td>\n",
       "      <td>0.000551</td>\n",
       "      <td>61267050.0</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "      <td>0.016957</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>(8, 3, 32)</td>\n",
       "      <td>0.975</td>\n",
       "      <td>0.000872</td>\n",
       "      <td>51633258.0</td>\n",
       "      <td>(9, 3, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>4</td>\n",
       "      <td>0.086072</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>(6, 5, 32)</td>\n",
       "      <td>0.975</td>\n",
       "      <td>0.000726</td>\n",
       "      <td>101608554.0</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>2</td>\n",
       "      <td>0.052575</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>(7, 5, 32)</td>\n",
       "      <td>0.980</td>\n",
       "      <td>0.000860</td>\n",
       "      <td>121779306.0</td>\n",
       "      <td>(6, 5, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>4</td>\n",
       "      <td>0.086072</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>(10, 3, 32)</td>\n",
       "      <td>0.983</td>\n",
       "      <td>0.001035</td>\n",
       "      <td>66284650.0</td>\n",
       "      <td>(10, 5, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>3</td>\n",
       "      <td>0.070278</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>(4, 5, 64)</td>\n",
       "      <td>0.986</td>\n",
       "      <td>0.000885</td>\n",
       "      <td>242956490.0</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "      <td>0.016957</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>(8, 5, 32)</td>\n",
       "      <td>0.987</td>\n",
       "      <td>0.000919</td>\n",
       "      <td>141950058.0</td>\n",
       "      <td>(6, 5, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>4</td>\n",
       "      <td>0.086072</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>(10, 5, 32)</td>\n",
       "      <td>0.988</td>\n",
       "      <td>0.001160</td>\n",
       "      <td>182291562.0</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>2</td>\n",
       "      <td>0.052575</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>(9, 3, 64)</td>\n",
       "      <td>0.991</td>\n",
       "      <td>0.001337</td>\n",
       "      <td>233523402.0</td>\n",
       "      <td>(9, 3, 32)</td>\n",
       "      <td>None</td>\n",
       "      <td>2</td>\n",
       "      <td>0.052575</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         archid  Partial training Validation Accuracy (1 epoch)  ONNX Latency (ms)        FLOPs       parent parents  iteration_num  Search walltime (hours)  is_pareto\n",
       "46   (1, 3, 64)                                           0.264           0.000239     706762.0  (1, 7, 128)    None              4                 0.086072       True\n",
       "10   (1, 5, 32)                                           0.274           0.000251     754794.0  (1, 5, 128)    None              1                 0.032674       True\n",
       "4    (1, 7, 32)                                           0.310           0.000208    1356906.0         None    None              0                 0.016957       True\n",
       "35   (1, 7, 64)                                           0.326           0.000236    2713802.0   (9, 3, 64)    None              3                 0.070278       True\n",
       "7   (1, 5, 128)                                           0.335           0.000296    3019146.0         None    None              0                 0.016957       True\n",
       "2   (1, 7, 128)                                           0.385           0.000249    5427594.0         None    None              0                 0.016957       True\n",
       "39   (2, 3, 32)                                           0.456           0.000285    7679082.0   (9, 3, 32)    None              3                 0.070278       True\n",
       "48   (2, 3, 64)                                           0.569           0.000370   29808842.0   (2, 3, 32)    None              4                 0.086072       True\n",
       "15   (3, 3, 32)                                           0.710           0.000445   15004778.0   (6, 3, 32)    None              1                 0.032674       True\n",
       "22   (4, 3, 32)                                           0.829           0.000490   22330474.0   (6, 3, 32)    None              2                 0.052575       True\n",
       "21   (2, 7, 32)                                           0.886           0.000458   40795242.0   (9, 7, 32)    None              2                 0.052575       True\n",
       "31   (5, 3, 32)                                           0.922           0.000627   29656170.0   (4, 3, 32)    None              3                 0.070278       True\n",
       "26   (3, 5, 32)                                           0.946           0.000479   41096298.0   (3, 3, 32)    None              2                 0.052575       True\n",
       "1    (6, 3, 32)                                           0.949           0.000722   36981866.0         None    None              0                 0.016957       True\n",
       "29   (7, 3, 32)                                           0.956           0.000851   44307562.0   (9, 3, 32)    None              2                 0.052575       True\n",
       "5    (4, 5, 32)                                           0.974           0.000551   61267050.0         None    None              0                 0.016957       True\n",
       "49   (8, 3, 32)                                           0.975           0.000872   51633258.0   (9, 3, 32)    None              4                 0.086072       True\n",
       "28   (6, 5, 32)                                           0.975           0.000726  101608554.0         None    None              2                 0.052575       True\n",
       "44   (7, 5, 32)                                           0.980           0.000860  121779306.0   (6, 5, 32)    None              4                 0.086072       True\n",
       "30  (10, 3, 32)                                           0.983           0.001035   66284650.0  (10, 5, 32)    None              3                 0.070278       True\n",
       "6    (4, 5, 64)                                           0.986           0.000885  242956490.0         None    None              0                 0.016957       True\n",
       "40   (8, 5, 32)                                           0.987           0.000919  141950058.0   (6, 5, 32)    None              4                 0.086072       True\n",
       "25  (10, 5, 32)                                           0.988           0.001160  182291562.0         None    None              2                 0.052575       True\n",
       "20   (9, 3, 64)                                           0.991           0.001337  233523402.0   (9, 3, 32)    None              2                 0.052575       True"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# NBVAL_SKIP\n",
    "search_results.get_search_state_df().query('is_pareto').sort_values('Partial training Validation Accuracy (1 epoch)')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "364fdfd0",
   "metadata": {},
   "source": [
    "Since our search space is also compatible with Bayesian Optimization algorithms, let's try more sophisticated algorithm like MO-BANANAS. \n",
    "\n",
    "MO-BANANAS will progressively train a surrogate model based on the data gathered during search. This surrogate model will be used to predict the result of expensive objective function evaluations and will try to determine what are the best possible architectures according to the surrogate model."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "6617b53c",
   "metadata": {},
   "outputs": [],
   "source": [
    "from archai.discrete_search.algos.bananas import MoBananasSearch"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "db035881",
   "metadata": {},
   "outputs": [],
   "source": [
    "algo2 = MoBananasSearch(\n",
    "    ss, objectives, dataset_provider, \n",
    "    output_dir='./out_bananas', \n",
    "    num_iters=5, mutations_per_parent=5,\n",
    "    num_candidates=20\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "d50b0279",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "14:01 Starting iteration 0\n",
      "14:01 Evaluating objectives for 10 architectures\n",
      "14:02 Updating surrogate model...\n",
      "Training DNN Ensemble...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:26<00:00,  5.39s/it]\n",
      "/home/pkauffmann/archai/archai/discrete_search/utils/multi_objective.py:53: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\n",
      "  frontiers = np.array(\n",
      "14:02 Generating mutations for 10 parent architectures...\n",
      "14:02 Found 36 new architectures satisfying constraints.\n",
      "14:02 Predicting ['Partial training Validation Accuracy (1 epoch)'] for new architectures using surrogate model\n",
      "14:02 Calculating cheap objectives {'ONNX Latency (ms)': {'objective': <archai.discrete_search.evaluators.onnx_model.AvgOnnxLatency object at 0x7fd1fc88c760>, 'higher_is_better': False, 'constraint': None}, 'FLOPs': {'objective': <archai.discrete_search.evaluators.torch_model.TensorwatchStat object at 0x7fd1fc88c700>, 'higher_is_better': False, 'constraint': (0.0, 1000000000.0)}} for new architectures\n",
      "14:02 Best 20 candidate architectures were selected for the next iteration\n",
      "14:02 Starting iteration 1\n",
      "14:02 Evaluating objectives for 20 architectures\n",
      "14:03 Updating surrogate model...\n",
      "Training DNN Ensemble...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:27<00:00,  5.42s/it]\n",
      "/home/pkauffmann/archai/archai/discrete_search/utils/multi_objective.py:53: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\n",
      "  frontiers = np.array(\n",
      "14:04 Generating mutations for 10 parent architectures...\n",
      "14:04 Found 26 new architectures satisfying constraints.\n",
      "14:04 Predicting ['Partial training Validation Accuracy (1 epoch)'] for new architectures using surrogate model\n",
      "14:04 Calculating cheap objectives {'ONNX Latency (ms)': {'objective': <archai.discrete_search.evaluators.onnx_model.AvgOnnxLatency object at 0x7fd1fc88c760>, 'higher_is_better': False, 'constraint': None}, 'FLOPs': {'objective': <archai.discrete_search.evaluators.torch_model.TensorwatchStat object at 0x7fd1fc88c700>, 'higher_is_better': False, 'constraint': (0.0, 1000000000.0)}} for new architectures\n",
      "14:04 Best 20 candidate architectures were selected for the next iteration\n",
      "14:04 Starting iteration 2\n",
      "14:04 Evaluating objectives for 20 architectures\n",
      "14:05 Updating surrogate model...\n",
      "Training DNN Ensemble...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:26<00:00,  5.40s/it]\n",
      "/home/pkauffmann/archai/archai/discrete_search/utils/multi_objective.py:53: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\n",
      "  frontiers = np.array(\n",
      "14:05 Generating mutations for 10 parent architectures...\n",
      "14:05 Found 6 new architectures satisfying constraints.\n",
      "14:05 Predicting ['Partial training Validation Accuracy (1 epoch)'] for new architectures using surrogate model\n",
      "14:05 Calculating cheap objectives {'ONNX Latency (ms)': {'objective': <archai.discrete_search.evaluators.onnx_model.AvgOnnxLatency object at 0x7fd1fc88c760>, 'higher_is_better': False, 'constraint': None}, 'FLOPs': {'objective': <archai.discrete_search.evaluators.torch_model.TensorwatchStat object at 0x7fd1fc88c700>, 'higher_is_better': False, 'constraint': (0.0, 1000000000.0)}} for new architectures\n",
      "14:05 Best 20 candidate architectures were selected for the next iteration\n",
      "14:05 Starting iteration 3\n",
      "14:05 Evaluating objectives for 6 architectures\n",
      "14:06 Updating surrogate model...\n",
      "Training DNN Ensemble...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:26<00:00,  5.31s/it]\n",
      "/home/pkauffmann/archai/archai/discrete_search/utils/multi_objective.py:53: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\n",
      "  frontiers = np.array(\n",
      "14:06 Generating mutations for 10 parent architectures...\n",
      "14:06 Found 1 new architectures satisfying constraints.\n",
      "14:06 Predicting ['Partial training Validation Accuracy (1 epoch)'] for new architectures using surrogate model\n",
      "14:06 Calculating cheap objectives {'ONNX Latency (ms)': {'objective': <archai.discrete_search.evaluators.onnx_model.AvgOnnxLatency object at 0x7fd1fc88c760>, 'higher_is_better': False, 'constraint': None}, 'FLOPs': {'objective': <archai.discrete_search.evaluators.torch_model.TensorwatchStat object at 0x7fd1fc88c700>, 'higher_is_better': False, 'constraint': (0.0, 1000000000.0)}} for new architectures\n",
      "14:06 Best 20 candidate architectures were selected for the next iteration\n",
      "14:06 Starting iteration 4\n",
      "14:06 Evaluating objectives for 1 architectures\n",
      "14:06 Updating surrogate model...\n",
      "Training DNN Ensemble...: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:26<00:00,  5.26s/it]\n",
      "/home/pkauffmann/archai/archai/discrete_search/utils/multi_objective.py:53: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.\n",
      "  frontiers = np.array(\n",
      "14:07 Generating mutations for 10 parent architectures...\n",
      "14:07 Found 3 new architectures satisfying constraints.\n",
      "14:07 Predicting ['Partial training Validation Accuracy (1 epoch)'] for new architectures using surrogate model\n",
      "14:07 Calculating cheap objectives {'ONNX Latency (ms)': {'objective': <archai.discrete_search.evaluators.onnx_model.AvgOnnxLatency object at 0x7fd1fc88c760>, 'higher_is_better': False, 'constraint': None}, 'FLOPs': {'objective': <archai.discrete_search.evaluators.torch_model.TensorwatchStat object at 0x7fd1fc88c700>, 'higher_is_better': False, 'constraint': (0.0, 1000000000.0)}} for new architectures\n",
      "14:07 Best 20 candidate architectures were selected for the next iteration\n"
     ]
    }
   ],
   "source": [
    "# NBVAL_SKIP\n",
    "search_results2 = algo2.search()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "b90c31a5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "log.log\r\n",
      "pareto_FLOPs_vs_Partial_training_Validation_Accuracy_1_epoch.png\r\n",
      "pareto_ONNX_Latency_ms_vs_FLOPs.png\r\n",
      "pareto_ONNX_Latency_ms_vs_Partial_training_Validation_Accuracy_1_epoch.png\r\n",
      "search_state_0.csv\r\n",
      "search_state_1.csv\r\n",
      "search_state_2.csv\r\n",
      "search_state_3.csv\r\n",
      "search_state_4.csv\r\n"
     ]
    }
   ],
   "source": [
    "# NBVAL_SKIP\n",
    "!ls ./out_bananas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "04d165b6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 720x360 with 2 Axes>"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# NBVAL_SKIP\n",
    "search_results2.plot_2d_pareto_evolution(('ONNX Latency (ms)', 'Partial training Validation Accuracy (1 epoch)'))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e2df08e8",
   "metadata": {},
   "source": [
    "MO-BANANAS will also save the predictive mean and variance of the expensive objectives during that iteration ."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "a9bbcc8d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>archid</th>\n",
       "      <th>Partial training Validation Accuracy (1 epoch)</th>\n",
       "      <th>ONNX Latency (ms)</th>\n",
       "      <th>FLOPs</th>\n",
       "      <th>iteration_num</th>\n",
       "      <th>Predicted Partial training Validation Accuracy (1 epoch) mean</th>\n",
       "      <th>Predicted Partial training Validation Accuracy (1 epoch) var</th>\n",
       "      <th>Search walltime (hours)</th>\n",
       "      <th>is_pareto</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>(1, 3, 32)</td>\n",
       "      <td>0.248</td>\n",
       "      <td>0.000254</td>\n",
       "      <td>353386.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.248418</td>\n",
       "      <td>2.047968e-03</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>(1, 3, 64)</td>\n",
       "      <td>0.264</td>\n",
       "      <td>0.000239</td>\n",
       "      <td>706762.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.520867</td>\n",
       "      <td>2.725258e-04</td>\n",
       "      <td>0.035050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>(1, 5, 32)</td>\n",
       "      <td>0.274</td>\n",
       "      <td>0.000251</td>\n",
       "      <td>754794.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.524827</td>\n",
       "      <td>2.408193e-03</td>\n",
       "      <td>0.035050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>(1, 7, 32)</td>\n",
       "      <td>0.310</td>\n",
       "      <td>0.000208</td>\n",
       "      <td>1356906.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.750090</td>\n",
       "      <td>2.623198e-04</td>\n",
       "      <td>0.035050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>(1, 7, 64)</td>\n",
       "      <td>0.326</td>\n",
       "      <td>0.000236</td>\n",
       "      <td>2713802.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.558949</td>\n",
       "      <td>1.281874e-03</td>\n",
       "      <td>0.035050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>(1, 5, 128)</td>\n",
       "      <td>0.335</td>\n",
       "      <td>0.000296</td>\n",
       "      <td>3019146.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.305024</td>\n",
       "      <td>7.075308e-04</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>(1, 7, 128)</td>\n",
       "      <td>0.385</td>\n",
       "      <td>0.000249</td>\n",
       "      <td>5427594.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.009741</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>(2, 3, 32)</td>\n",
       "      <td>0.456</td>\n",
       "      <td>0.000285</td>\n",
       "      <td>7679082.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.459846</td>\n",
       "      <td>1.940939e-03</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>(2, 3, 64)</td>\n",
       "      <td>0.569</td>\n",
       "      <td>0.000370</td>\n",
       "      <td>29808842.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.693631</td>\n",
       "      <td>3.133334e-05</td>\n",
       "      <td>0.035050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>(2, 5, 32)</td>\n",
       "      <td>0.666</td>\n",
       "      <td>0.000389</td>\n",
       "      <td>20925546.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.607475</td>\n",
       "      <td>8.238424e-04</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>(3, 3, 32)</td>\n",
       "      <td>0.710</td>\n",
       "      <td>0.000445</td>\n",
       "      <td>15004778.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.679987</td>\n",
       "      <td>1.583403e-03</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>(4, 3, 32)</td>\n",
       "      <td>0.829</td>\n",
       "      <td>0.000490</td>\n",
       "      <td>22330474.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.939183</td>\n",
       "      <td>1.354675e-04</td>\n",
       "      <td>0.035050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>(2, 7, 32)</td>\n",
       "      <td>0.886</td>\n",
       "      <td>0.000458</td>\n",
       "      <td>40795242.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.009741</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>(5, 3, 32)</td>\n",
       "      <td>0.922</td>\n",
       "      <td>0.000627</td>\n",
       "      <td>29656170.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.945611</td>\n",
       "      <td>8.060229e-06</td>\n",
       "      <td>0.035050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>(3, 5, 32)</td>\n",
       "      <td>0.946</td>\n",
       "      <td>0.000479</td>\n",
       "      <td>41096298.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.842660</td>\n",
       "      <td>5.665877e-04</td>\n",
       "      <td>0.035050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>(6, 3, 32)</td>\n",
       "      <td>0.949</td>\n",
       "      <td>0.000722</td>\n",
       "      <td>36981866.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.009741</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>(7, 3, 32)</td>\n",
       "      <td>0.956</td>\n",
       "      <td>0.000851</td>\n",
       "      <td>44307562.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.963334</td>\n",
       "      <td>4.732862e-07</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>(4, 5, 32)</td>\n",
       "      <td>0.974</td>\n",
       "      <td>0.000551</td>\n",
       "      <td>61267050.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.009741</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>(8, 3, 32)</td>\n",
       "      <td>0.975</td>\n",
       "      <td>0.000872</td>\n",
       "      <td>51633258.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.969070</td>\n",
       "      <td>5.998997e-05</td>\n",
       "      <td>0.035050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>(6, 5, 32)</td>\n",
       "      <td>0.975</td>\n",
       "      <td>0.000726</td>\n",
       "      <td>101608554.0</td>\n",
       "      <td>1</td>\n",
       "      <td>0.974126</td>\n",
       "      <td>5.820624e-05</td>\n",
       "      <td>0.035050</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>(7, 5, 32)</td>\n",
       "      <td>0.980</td>\n",
       "      <td>0.000860</td>\n",
       "      <td>121779306.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.980158</td>\n",
       "      <td>6.198977e-07</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>(10, 3, 32)</td>\n",
       "      <td>0.983</td>\n",
       "      <td>0.001035</td>\n",
       "      <td>66284650.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.994888</td>\n",
       "      <td>3.606799e-06</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>(6, 3, 64)</td>\n",
       "      <td>0.983</td>\n",
       "      <td>0.000895</td>\n",
       "      <td>146217162.0</td>\n",
       "      <td>3</td>\n",
       "      <td>0.976682</td>\n",
       "      <td>7.886449e-07</td>\n",
       "      <td>0.079053</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>(4, 5, 64)</td>\n",
       "      <td>0.986</td>\n",
       "      <td>0.000885</td>\n",
       "      <td>242956490.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.961790</td>\n",
       "      <td>4.393400e-05</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>(8, 5, 32)</td>\n",
       "      <td>0.987</td>\n",
       "      <td>0.000919</td>\n",
       "      <td>141950058.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.009741</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>(10, 5, 32)</td>\n",
       "      <td>0.988</td>\n",
       "      <td>0.001160</td>\n",
       "      <td>182291562.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0.996126</td>\n",
       "      <td>6.905550e-06</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>(9, 3, 64)</td>\n",
       "      <td>0.991</td>\n",
       "      <td>0.001337</td>\n",
       "      <td>233523402.0</td>\n",
       "      <td>2</td>\n",
       "      <td>1.008927</td>\n",
       "      <td>1.038860e-04</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>(10, 3, 64)</td>\n",
       "      <td>0.991</td>\n",
       "      <td>0.001333</td>\n",
       "      <td>262625482.0</td>\n",
       "      <td>2</td>\n",
       "      <td>1.019735</td>\n",
       "      <td>1.448977e-04</td>\n",
       "      <td>0.059447</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         archid  Partial training Validation Accuracy (1 epoch)  ONNX Latency (ms)        FLOPs  iteration_num  Predicted Partial training Validation Accuracy (1 epoch) mean  Predicted Partial training Validation Accuracy (1 epoch) var  Search walltime (hours)  is_pareto\n",
       "37   (1, 3, 32)                                           0.248           0.000254     353386.0              2                                           0.248418                                                   2.047968e-03                            0.059447       True\n",
       "16   (1, 3, 64)                                           0.264           0.000239     706762.0              1                                           0.520867                                                   2.725258e-04                            0.035050       True\n",
       "10   (1, 5, 32)                                           0.274           0.000251     754794.0              1                                           0.524827                                                   2.408193e-03                            0.035050       True\n",
       "19   (1, 7, 32)                                           0.310           0.000208    1356906.0              1                                           0.750090                                                   2.623198e-04                            0.035050       True\n",
       "26   (1, 7, 64)                                           0.326           0.000236    2713802.0              1                                           0.558949                                                   1.281874e-03                            0.035050       True\n",
       "32  (1, 5, 128)                                           0.335           0.000296    3019146.0              2                                           0.305024                                                   7.075308e-04                            0.059447       True\n",
       "2   (1, 7, 128)                                           0.385           0.000249    5427594.0              0                                                NaN                                                            NaN                            0.009741       True\n",
       "36   (2, 3, 32)                                           0.456           0.000285    7679082.0              2                                           0.459846                                                   1.940939e-03                            0.059447       True\n",
       "28   (2, 3, 64)                                           0.569           0.000370   29808842.0              1                                           0.693631                                                   3.133334e-05                            0.035050       True\n",
       "35   (2, 5, 32)                                           0.666           0.000389   20925546.0              2                                           0.607475                                                   8.238424e-04                            0.059447       True\n",
       "33   (3, 3, 32)                                           0.710           0.000445   15004778.0              2                                           0.679987                                                   1.583403e-03                            0.059447       True\n",
       "12   (4, 3, 32)                                           0.829           0.000490   22330474.0              1                                           0.939183                                                   1.354675e-04                            0.035050       True\n",
       "7    (2, 7, 32)                                           0.886           0.000458   40795242.0              0                                                NaN                                                            NaN                            0.009741       True\n",
       "15   (5, 3, 32)                                           0.922           0.000627   29656170.0              1                                           0.945611                                                   8.060229e-06                            0.035050       True\n",
       "21   (3, 5, 32)                                           0.946           0.000479   41096298.0              1                                           0.842660                                                   5.665877e-04                            0.035050       True\n",
       "0    (6, 3, 32)                                           0.949           0.000722   36981866.0              0                                                NaN                                                            NaN                            0.009741       True\n",
       "39   (7, 3, 32)                                           0.956           0.000851   44307562.0              2                                           0.963334                                                   4.732862e-07                            0.059447       True\n",
       "6    (4, 5, 32)                                           0.974           0.000551   61267050.0              0                                                NaN                                                            NaN                            0.009741       True\n",
       "23   (8, 3, 32)                                           0.975           0.000872   51633258.0              1                                           0.969070                                                   5.998997e-05                            0.035050       True\n",
       "22   (6, 5, 32)                                           0.975           0.000726  101608554.0              1                                           0.974126                                                   5.820624e-05                            0.035050       True\n",
       "34   (7, 5, 32)                                           0.980           0.000860  121779306.0              2                                           0.980158                                                   6.198977e-07                            0.059447       True\n",
       "40  (10, 3, 32)                                           0.983           0.001035   66284650.0              2                                           0.994888                                                   3.606799e-06                            0.059447       True\n",
       "50   (6, 3, 64)                                           0.983           0.000895  146217162.0              3                                           0.976682                                                   7.886449e-07                            0.079053       True\n",
       "44   (4, 5, 64)                                           0.986           0.000885  242956490.0              2                                           0.961790                                                   4.393400e-05                            0.059447       True\n",
       "3    (8, 5, 32)                                           0.987           0.000919  141950058.0              0                                                NaN                                                            NaN                            0.009741       True\n",
       "31  (10, 5, 32)                                           0.988           0.001160  182291562.0              2                                           0.996126                                                   6.905550e-06                            0.059447       True\n",
       "38   (9, 3, 64)                                           0.991           0.001337  233523402.0              2                                           1.008927                                                   1.038860e-04                            0.059447       True\n",
       "30  (10, 3, 64)                                           0.991           0.001333  262625482.0              2                                           1.019735                                                   1.448977e-04                            0.059447       True"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# NBVAL_SKIP\n",
    "search_results2.get_search_state_df().query('is_pareto').sort_values('Partial training Validation Accuracy (1 epoch)')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "archai",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.13"
  },
  "vscode": {
   "interpreter": {
    "hash": "9fbf74c2a5b2277518aab34976c77c13dbb1703a6ac8dc7322f20b113fdc89e6"
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
